INFO:root:Saving trial details to /glade/work/kdagon/s2sml/testGust_results/
INFO:root:Running on PBS/SLURM batch id: 27943.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: minimize
INFO:root:Using metric valid_mae
[32m[I 2023-05-02 17:16:57,564][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/testGust_results/s2s.db
INFO:echo.src.base_objective:Worker 27943.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric valid_mae
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
INFO:root:Running optimization for 10 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.007466324088845748
INFO:echo.src.base_objective:	trainer:train_batch_size : 51
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 0
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 0 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:21:21,807][0m Trial 0 finished with value: 0.06904369033873081 and parameters: {'learning_rate': 0.007466324088845748, 'norm': 'minmax', 'train_batch_size': 51, 'training_loss': 'logcosh', 'model_name': 'unet'}. Best is trial 0 with value: 0.06904369033873081.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 9.745282874167088e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 29
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 1
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 1 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:23:58,228][0m Trial 1 finished with value: 0.046830229461193085 and parameters: {'learning_rate': 9.745282874167088e-05, 'norm': 'minmax', 'train_batch_size': 29, 'training_loss': 'xtanh', 'model_name': 'unet'}. Best is trial 1 with value: 0.046830229461193085.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 3.482694840072424e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 38
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 2
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 2 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:26:27,301][0m Trial 2 finished with value: 0.7179318219423294 and parameters: {'learning_rate': 3.482694840072424e-05, 'norm': 'zscore', 'train_batch_size': 38, 'training_loss': 'huber', 'model_name': 'unet'}. Best is trial 1 with value: 0.046830229461193085.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00015054940948797604
INFO:echo.src.base_objective:	trainer:train_batch_size : 51
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 3
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 3 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:28:53,536][0m Trial 3 finished with value: 0.669959306716919 and parameters: {'learning_rate': 0.00015054940948797604, 'norm': 'zscore', 'train_batch_size': 51, 'training_loss': 'mse', 'model_name': 'unet'}. Best is trial 1 with value: 0.046830229461193085.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.4939668329809957e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 50
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 4
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 4 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:31:17,356][0m Trial 4 finished with value: 0.14763697236776352 and parameters: {'learning_rate': 1.4939668329809957e-05, 'norm': 'minmax', 'train_batch_size': 50, 'training_loss': 'logcosh', 'model_name': 'unet'}. Best is trial 1 with value: 0.046830229461193085.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00197454161328748
INFO:echo.src.base_objective:	trainer:train_batch_size : 28
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 5
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 5 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:33:45,269][0m Trial 5 finished with value: 0.03857158683240414 and parameters: {'learning_rate': 0.00197454161328748, 'norm': 'minmax', 'train_batch_size': 28, 'training_loss': 'mae', 'model_name': 'unet'}. Best is trial 5 with value: 0.03857158683240414.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00018146594661987289
INFO:echo.src.base_objective:	trainer:train_batch_size : 19
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 6
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 6 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:36:15,073][0m Trial 6 finished with value: 0.6348887532949448 and parameters: {'learning_rate': 0.00018146594661987289, 'norm': 'zscore', 'train_batch_size': 19, 'training_loss': 'logcosh', 'model_name': 'unet'}. Best is trial 5 with value: 0.03857158683240414.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00011889257919968194
INFO:echo.src.base_objective:	trainer:train_batch_size : 19
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 7
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 7 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:38:48,163][0m Trial 7 finished with value: 0.6434588357806206 and parameters: {'learning_rate': 0.00011889257919968194, 'norm': 'zscore', 'train_batch_size': 19, 'training_loss': 'xsigmoid', 'model_name': 'unet'}. Best is trial 5 with value: 0.03857158683240414.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.3178988625614025e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 23
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 8
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 8 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:41:17,726][0m Trial 8 finished with value: 0.7141317501664162 and parameters: {'learning_rate': 2.3178988625614025e-05, 'norm': 'zscore', 'train_batch_size': 23, 'training_loss': 'logcosh', 'model_name': 'unet'}. Best is trial 5 with value: 0.03857158683240414.[0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002997354626539196
INFO:echo.src.base_objective:	trainer:train_batch_size : 41
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 9
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 9 results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27943.gusched01.csv
[32m[I 2023-05-02 17:43:46,580][0m Trial 9 finished with value: 0.6259762644767761 and parameters: {'learning_rate': 0.002997354626539196, 'norm': 'zscore', 'train_batch_size': 41, 'training_loss': 'xsigmoid', 'model_name': 'unet'}. Best is trial 5 with value: 0.03857158683240414.[0m
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/testGust_results/
INFO:root:Running on PBS/SLURM batch id: 27944.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: minimize
INFO:root:Using metric valid_mae
[32m[I 2023-05-02 17:44:21,016][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/testGust_results/s2s.db
INFO:echo.src.base_objective:Worker 27944.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric valid_mae
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/testGust_results/trial_results/trial_results_27944.gusched01.csv
INFO:root:Running optimization for 10 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
