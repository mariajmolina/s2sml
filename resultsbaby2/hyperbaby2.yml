log: True
save_path: "/glade/work/kdagon/s2sml/resultsbaby/" # KD: changed path

pbs:
  jobs: 2 # KD: changed # jobs
  #kernel: "ncar_pylib /glade/work/$USER/py37 # KD: commented out this line
  bash: ["source ~/.bashrc; module unload cuda; conda activate s2sml-env"] # KD: modified to module unload cuda and conda activate $ENV
  batch:
    N: "s2sml-kdagon" # KD: changed name
    l: ["select=1:ncpus=4:ngpus=1:mem=32GB", "walltime=6:00:00", "gpu_type=v100"] # KD: changed resource request
    A: "ACGD0007" # KD: changed account number
    q: "casper"
    o: "/glade/work/kdagon/s2sml/resultsbaby/out" # KD: changed path
    e: "/glade/work/kdagon/s2sml/resultsbaby/err" # KD: changed path
    
optuna:
  storage: "s2s.db"
  study_name: "vanillababy" # changed name
  storage_type: "sqlite"
  objective: "/glade/work/kdagon/s2sml/applications/train.py" # KD: changed path
  direction: "minimize"
  metric: "valid_mae"
  n_trials: 10 # changed # trials
  gpu: True
  sampler:
    type: "TPESampler"
    n_startup_trials: 100
  pruner:
    type: "MedianPruner"
    n_startup_trials: 50
  parameters:
    optimizer:learning_rate:
      type: "loguniform"
      settings:
        name: "learning_rate"
        low: 1.0e-05 # changed low LR
        high: 1.0e-02
    data:norm:
      type: "categorical"
      settings:
        name: "norm"
        choices: ["minmax", "zscore"]
    #trainer:weight_decay: # commented out
    #  type: "loguniform"
    #  settings:
    #    name: "weight_decay"
    #    low: 1.0e-12
    #    high: 1.0e-03
    trainer:train_batch_size:
      type: "int"
      settings:
        name: "train_batch_size"
        low: 16 # changed
        high: 64 # changed
    trainer:training_loss:
      type: "categorical"
      settings:
        name: "training_loss"
        choices: ["mae", "mse"] # removed some options
    model:name:
      type: "categorical"
      settings:
        name: "model_name"
        choices: ["unet"] # removed some options
    #model:encoder_name: # KD: commented this out due to connection errors
    #  type: "categorical"
    #  settings:
    #    name: "encoder_name"
    #    choices: ["resnet18", "resnet152", "densenet121", "xception", "efficientnet-b0", "mobilenet_v2", "dpn68", "vgg11"]
