INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29807.gusched01
INFO:root:Running on PBS/SLURM batch id: 29808.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 15:28:25,938][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
[32m[I 2023-05-15 15:28:25,939][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29807.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29807.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29808.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29808.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0007244169897842657
INFO:echo.src.base_objective:	trainer:train_batch_size : 72
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0003563372592711742
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 0
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0007291131278606368
INFO:echo.src.base_objective:	trainer:train_batch_size : 69
INFO:echo.src.base_objective:	trainer:weight_decay : 8.820187429005921e-10
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 1
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 1 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29808.gusched01.csv
[32m[I 2023-05-15 15:41:50,770][0m Trial 1 finished with values: [1.0314923904258184, 1.2914674051426158, 1.1683407352880195] and parameters: {'learning_rate': 0.0007291131278606368, 'norm': 'minmax', 'weight_decay': 8.820187429005921e-10, 'train_batch_size': 69, 'training_loss': 'xtanh', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0044041396570147434
INFO:echo.src.base_objective:	trainer:train_batch_size : 93
INFO:echo.src.base_objective:	trainer:weight_decay : 9.686252228913244e-07
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 2
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 0 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29807.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 15:44:26,984][0m Trial 0 finished with values: [1.0142489313781007, 0.946606017250634, 0.9202209150545435] and parameters: {'learning_rate': 0.0007244169897842657, 'norm': 'minmax', 'weight_decay': 0.0003563372592711742, 'train_batch_size': 72, 'training_loss': 'logcosh', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00020106272399616354
INFO:echo.src.base_objective:	trainer:train_batch_size : 17
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0003457871263194445
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 3
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 2 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29808.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 15:49:25,808][0m Trial 2 finished with values: [26.94447975158926, 12056.517145356027, 162.33537089427594] and parameters: {'learning_rate': 0.0044041396570147434, 'norm': 'None', 'weight_decay': 9.686252228913244e-07, 'train_batch_size': 93, 'training_loss': 'mse', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.6571567941573003e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 28
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0004886767616092857
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 4
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 3 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29807.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 15:55:39,555][0m Trial 3 finished with values: [1.1542321395464599, 3.6844893932101352, 2.0902240874765625] and parameters: {'learning_rate': 0.00020106272399616354, 'norm': 'zscore', 'weight_decay': 0.0003457871263194445, 'train_batch_size': 17, 'training_loss': 'mse', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 7.291871985889319e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 39
INFO:echo.src.base_objective:	trainer:weight_decay : 2.348787222644882e-05
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 5
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 5 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29807.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:17:17,380][0m Trial 5 finished with values: [1.2772670539117577, 3.369817107280385, 2.097706164805902] and parameters: {'learning_rate': 7.291871985889319e-06, 'norm': 'minmax', 'weight_decay': 2.348787222644882e-05, 'train_batch_size': 39, 'training_loss': 'smooth', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 3.6934624978451226e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 63
INFO:echo.src.base_objective:	trainer:weight_decay : 6.747085463275048e-05
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 6
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 4 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29808.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:27:58,955][0m Trial 4 finished with values: [1.2103848534787056, 6.647368119725359, 3.1940592323128962] and parameters: {'learning_rate': 1.6571567941573003e-06, 'norm': 'negone', 'weight_decay': 0.0004886767616092857, 'train_batch_size': 28, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.6492323919800125e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 97
INFO:echo.src.base_objective:	trainer:weight_decay : 8.966346907110688e-05
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 7
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 7 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29808.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:38:41,314][0m Trial 7 finished with values: [1.0497132461942011, 1.7070653024225448, 1.4682536309915508] and parameters: {'learning_rate': 2.6492323919800125e-05, 'norm': 'minmax', 'weight_decay': 8.966346907110688e-05, 'train_batch_size': 97, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0009394207697552794
INFO:echo.src.base_objective:	trainer:train_batch_size : 107
INFO:echo.src.base_objective:	trainer:weight_decay : 7.873162840378467e-06
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 8
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 8 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29808.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:46:12,682][0m Trial 8 finished with values: [1.1786385984096865, 3.867447687068986, 2.19354609434715] and parameters: {'learning_rate': 0.0009394207697552794, 'norm': 'zscore', 'weight_decay': 7.873162840378467e-06, 'train_batch_size': 107, 'training_loss': 'logcosh', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0031061109991745313
INFO:echo.src.base_objective:	trainer:train_batch_size : 53
INFO:echo.src.base_objective:	trainer:weight_decay : 3.107198497742131e-07
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 9
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 6 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29807.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:55:21,341][0m Trial 6 finished with values: [1.082582921808754, 6.347660204103818, 3.2670502675480195] and parameters: {'learning_rate': 3.6934624978451226e-06, 'norm': 'negone', 'weight_decay': 6.747085463275048e-05, 'train_batch_size': 63, 'training_loss': 'xtanh', 'model_name': 'unet++'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:echo.src.base_objective:Saving trial 9 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29808.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:55:52,177][0m Trial 9 finished with values: [1.0800314216157187, 1.604065890229391, 1.2660403670448446] and parameters: {'learning_rate': 0.0031061109991745313, 'norm': 'negone', 'weight_decay': 3.107198497742131e-07, 'train_batch_size': 53, 'training_loss': 'smooth', 'model_name': 'pspnet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29809.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29810.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 16:56:38,594][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
[32m[I 2023-05-15 16:56:38,596][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29810.gusched01 is summoned.
INFO:echo.src.base_objective:Worker 29809.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0002458180262234768
INFO:echo.src.base_objective:	trainer:train_batch_size : 69
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0006277624732018657
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 10
INFO:echo.src.base_objective:	data:norm : minmax
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.233640369528075e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 100
INFO:echo.src.base_objective:	trainer:weight_decay : 1.3593864166890444e-08
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 11
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 10 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:59:15,321][0m Trial 10 finished with values: [25.14106216422959, 12093.724527988952, 162.58580209888902] and parameters: {'learning_rate': 0.0002458180262234768, 'norm': 'None', 'weight_decay': 0.0006277624732018657, 'train_batch_size': 69, 'training_loss': 'logcosh', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00015242558663242106
INFO:echo.src.base_objective:	trainer:train_batch_size : 112
INFO:echo.src.base_objective:	trainer:weight_decay : 2.8803159499718976e-08
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 12
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 11 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 16:59:37,805][0m Trial 11 finished with values: [14.390658438160925, 18.136977171538135, 5.296075636738638] and parameters: {'learning_rate': 4.233640369528075e-06, 'norm': 'minmax', 'weight_decay': 1.3593864166890444e-08, 'train_batch_size': 100, 'training_loss': 'xtanh', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 3.105070451051848e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 15
INFO:echo.src.base_objective:	trainer:weight_decay : 7.745572074213735e-11
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 13
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 13 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:06:39,310][0m Trial 13 finished with values: [1.1583895964021194, 3.999411478251624, 2.227089189106744] and parameters: {'learning_rate': 3.105070451051848e-05, 'norm': 'zscore', 'weight_decay': 7.745572074213735e-11, 'train_batch_size': 15, 'training_loss': 'smooth', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.5677007053129574e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 27
INFO:echo.src.base_objective:	trainer:weight_decay : 0.00024498892374286504
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 14
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 12 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:06:56,736][0m Trial 12 finished with values: [1.0491966878920613, 2.381939369027058, 1.791526048582354] and parameters: {'learning_rate': 0.00015242558663242106, 'norm': 'negone', 'weight_decay': 2.8803159499718976e-08, 'train_batch_size': 112, 'training_loss': 'huber', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0013140189275691824
INFO:echo.src.base_objective:	trainer:train_batch_size : 32
INFO:echo.src.base_objective:	trainer:weight_decay : 6.66404587610107e-12
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 15
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 15 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:12:36,926][0m Trial 15 finished with values: [0.9644200541049518, 0.4241069203515197, 0.7061618418334905] and parameters: {'learning_rate': 0.0013140189275691824, 'norm': 'minmax', 'weight_decay': 6.66404587610107e-12, 'train_batch_size': 32, 'training_loss': 'logcosh', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 5.908628791025559e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 88
INFO:echo.src.base_objective:	trainer:weight_decay : 9.429939419508451e-12
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 16
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 14 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:29:07,106][0m Trial 14 finished with values: [0.966821141329495, 0.45299039346565506, 0.7489975928436254] and parameters: {'learning_rate': 1.5677007053129574e-05, 'norm': 'minmax', 'weight_decay': 0.00024498892374286504, 'train_batch_size': 27, 'training_loss': 'logcosh', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0003457321042763964
INFO:echo.src.base_objective:	trainer:train_batch_size : 41
INFO:echo.src.base_objective:	trainer:weight_decay : 5.4199806176227616e-05
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 17
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 17 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:37:14,874][0m Trial 17 finished with values: [1.0016592574326926, 1.2224549317322821, 1.1360436393160467] and parameters: {'learning_rate': 0.0003457321042763964, 'norm': 'negone', 'weight_decay': 5.4199806176227616e-05, 'train_batch_size': 41, 'training_loss': 'mse', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.004284001315474613
INFO:echo.src.base_objective:	trainer:train_batch_size : 118
INFO:echo.src.base_objective:	trainer:weight_decay : 1.3785591259245883e-10
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 18
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 18 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:44:14,990][0m Trial 18 finished with values: [1.0559549473184116, 1.3888936634130051, 1.185237740831705] and parameters: {'learning_rate': 0.004284001315474613, 'norm': 'negone', 'weight_decay': 1.3785591259245883e-10, 'train_batch_size': 118, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 3.392367579244501e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 101
INFO:echo.src.base_objective:	trainer:weight_decay : 1.999908269528814e-10
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 19
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 19 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:46:36,277][0m Trial 19 finished with values: [3.5020575766738267, 12103.943695057105, 162.65497410229793] and parameters: {'learning_rate': 3.392367579244501e-05, 'norm': 'None', 'weight_decay': 1.999908269528814e-10, 'train_batch_size': 101, 'training_loss': 'huber', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00025523748005522323
INFO:echo.src.base_objective:	trainer:train_batch_size : 46
INFO:echo.src.base_objective:	trainer:weight_decay : 2.6863777644937942e-05
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 20
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 16 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:47:06,454][0m Trial 16 finished with values: [1.0636249460570713, 4.416827653305993, 2.419446688496439] and parameters: {'learning_rate': 5.908628791025559e-06, 'norm': 'zscore', 'weight_decay': 9.429939419508451e-12, 'train_batch_size': 88, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 9.210206335525336e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 103
INFO:echo.src.base_objective:	trainer:weight_decay : 3.1217644070305195e-11
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 21
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 20 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:49:37,015][0m Trial 20 finished with values: [1.1353104340927322, 6.518215470210093, 3.0460322891284775] and parameters: {'learning_rate': 0.00025523748005522323, 'norm': 'zscore', 'weight_decay': 2.6863777644937942e-05, 'train_batch_size': 46, 'training_loss': 'xtanh', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0015964501161258074
INFO:echo.src.base_objective:	trainer:train_batch_size : 6
INFO:echo.src.base_objective:	trainer:weight_decay : 4.937423452518926e-08
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 22
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 22 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 17:55:25,239][0m Trial 22 finished with values: [12.01724119360739, 12056.510211818875, 162.33531882326153] and parameters: {'learning_rate': 0.0015964501161258074, 'norm': 'None', 'weight_decay': 4.937423452518926e-08, 'train_batch_size': 6, 'training_loss': 'logcosh', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00578869735910796
INFO:echo.src.base_objective:	trainer:train_batch_size : 111
INFO:echo.src.base_objective:	trainer:weight_decay : 2.2976488905072662e-07
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 23
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 21 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:03:01,421][0m Trial 21 finished with values: [0.9701595478363628, 0.4896956038058062, 0.7789776945674339] and parameters: {'learning_rate': 9.210206335525336e-05, 'norm': 'minmax', 'weight_decay': 3.1217644070305195e-11, 'train_batch_size': 103, 'training_loss': 'mse', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.004867103624458612
INFO:echo.src.base_objective:	trainer:train_batch_size : 30
INFO:echo.src.base_objective:	trainer:weight_decay : 5.54236892149174e-06
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 24
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 24 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:07:20,517][0m Trial 24 finished with values: [1.0970145333188128, 1.7183931778642545, 1.347425704940948] and parameters: {'learning_rate': 0.004867103624458612, 'norm': 'minmax', 'weight_decay': 5.54236892149174e-06, 'train_batch_size': 30, 'training_loss': 'xsigmoid', 'model_name': 'pspnet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 6.604706818648971e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 26
INFO:echo.src.base_objective:	trainer:weight_decay : 1.639615821021539e-08
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 25
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 23 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:08:25,402][0m Trial 23 finished with values: [1.0913961217942096, 1.6959128749517887, 1.3317896081147487] and parameters: {'learning_rate': 0.00578869735910796, 'norm': 'negone', 'weight_decay': 2.2976488905072662e-07, 'train_batch_size': 111, 'training_loss': 'logcosh', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.169644425002291e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 9
INFO:echo.src.base_objective:	trainer:weight_decay : 1.6597317758110658e-11
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 26
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 25 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29810.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:18:54,984][0m Trial 25 finished with values: [1.0858250447798898, 3.9774059179062062, 2.2296949270146498] and parameters: {'learning_rate': 6.604706818648971e-05, 'norm': 'zscore', 'weight_decay': 1.639615821021539e-08, 'train_batch_size': 26, 'training_loss': 'huber', 'model_name': 'linknet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29811.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 18:19:55,807][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29811.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0004601660050268863
INFO:echo.src.base_objective:	trainer:train_batch_size : 122
INFO:echo.src.base_objective:	trainer:weight_decay : 3.5532406106124137e-12
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 27
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 26 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29809.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:25:48,656][0m Trial 26 finished with values: [0.9708142999122836, 0.5134933174604852, 0.7906584082473938] and parameters: {'learning_rate': 4.169644425002291e-05, 'norm': 'minmax', 'weight_decay': 1.6597317758110658e-11, 'train_batch_size': 9, 'training_loss': 'logcosh', 'model_name': 'linknet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29812.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 18:26:13,126][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29812.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0001980673852387479
INFO:echo.src.base_objective:	trainer:train_batch_size : 38
INFO:echo.src.base_objective:	trainer:weight_decay : 8.271776892691221e-10
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 28
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 28 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:28:51,977][0m Trial 28 finished with values: [33.68883600644086, 12056.507611742445, 162.33530580550791] and parameters: {'learning_rate': 0.0001980673852387479, 'norm': 'None', 'weight_decay': 8.271776892691221e-10, 'train_batch_size': 38, 'training_loss': 'xsigmoid', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00010885637714639096
INFO:echo.src.base_objective:	trainer:train_batch_size : 109
INFO:echo.src.base_objective:	trainer:weight_decay : 4.234415590920676e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 29
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 27 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:30:26,742][0m Trial 27 finished with values: [1.0154668019106192, 0.9583762321167111, 0.940262192431384] and parameters: {'learning_rate': 0.0004601660050268863, 'norm': 'minmax', 'weight_decay': 3.5532406106124137e-12, 'train_batch_size': 122, 'training_loss': 'huber', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 5.841636915321234e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 16
INFO:echo.src.base_objective:	trainer:weight_decay : 7.109954558247119e-05
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 30
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 30 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:33:23,759][0m Trial 30 finished with values: [1.1850488517895026, 3.9458305697896665, 2.2204222646455465] and parameters: {'learning_rate': 5.841636915321234e-05, 'norm': 'zscore', 'weight_decay': 7.109954558247119e-05, 'train_batch_size': 16, 'training_loss': 'mse', 'model_name': 'pspnet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.004141868601807681
INFO:echo.src.base_objective:	trainer:train_batch_size : 68
INFO:echo.src.base_objective:	trainer:weight_decay : 9.273040925881323e-06
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 31
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 29 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:39:20,705][0m Trial 29 finished with values: [1.0917049239800423, 4.340174782706721, 2.382062455226724] and parameters: {'learning_rate': 0.00010885637714639096, 'norm': 'zscore', 'weight_decay': 4.234415590920676e-08, 'train_batch_size': 109, 'training_loss': 'mae', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0010107836248553434
INFO:echo.src.base_objective:	trainer:train_batch_size : 87
INFO:echo.src.base_objective:	trainer:weight_decay : 6.52423113373015e-11
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 32
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 31 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:40:53,256][0m Trial 31 finished with values: [1.0955526343412014, 3.610644979485104, 2.072711981968251] and parameters: {'learning_rate': 0.004141868601807681, 'norm': 'zscore', 'weight_decay': 9.273040925881323e-06, 'train_batch_size': 68, 'training_loss': 'mse', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.165966073043685e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 64
INFO:echo.src.base_objective:	trainer:weight_decay : 5.793944696978069e-12
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 33
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 33 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:53:03,789][0m Trial 33 finished with values: [1.1726235497624518, 4.092555528545524, 2.258885096811493] and parameters: {'learning_rate': 4.165966073043685e-05, 'norm': 'zscore', 'weight_decay': 5.793944696978069e-12, 'train_batch_size': 64, 'training_loss': 'xtanh', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.001623029468529714
INFO:echo.src.base_objective:	trainer:train_batch_size : 12
INFO:echo.src.base_objective:	trainer:weight_decay : 1.3958255955280437e-10
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 34
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 32 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:57:26,738][0m Trial 32 finished with values: [0.9606088290193577, 0.38180262487849703, 0.6735336775504139] and parameters: {'learning_rate': 0.0010107836248553434, 'norm': 'minmax', 'weight_decay': 6.52423113373015e-11, 'train_batch_size': 87, 'training_loss': 'mse', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.6967078201322287e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 25
INFO:echo.src.base_objective:	trainer:weight_decay : 4.0861200840565486e-05
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 35
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 34 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 18:57:54,286][0m Trial 34 finished with values: [0.9671454460389807, 0.48924948172318483, 0.7671092464632991] and parameters: {'learning_rate': 0.001623029468529714, 'norm': 'minmax', 'weight_decay': 1.3958255955280437e-10, 'train_batch_size': 12, 'training_loss': 'mse', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.9808385520904843e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 95
INFO:echo.src.base_objective:	trainer:weight_decay : 2.6148684131739444e-07
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 36
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 36 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:00:46,511][0m Trial 36 finished with values: [3.556816930766072, 7.3880311344605945, 3.2726295995598145] and parameters: {'learning_rate': 1.9808385520904843e-05, 'norm': 'zscore', 'weight_decay': 2.6148684131739444e-07, 'train_batch_size': 95, 'training_loss': 'mae', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.408213133181997e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 5
INFO:echo.src.base_objective:	trainer:weight_decay : 2.788724141409319e-10
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 37
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 35 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:03:09,111][0m Trial 35 finished with values: [46605.82749645724, 12082.395417181908, 162.50914054790573] and parameters: {'learning_rate': 2.6967078201322287e-05, 'norm': 'None', 'weight_decay': 4.0861200840565486e-05, 'train_batch_size': 25, 'training_loss': 'huber', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0005665905047332262
INFO:echo.src.base_objective:	trainer:train_batch_size : 78
INFO:echo.src.base_objective:	trainer:weight_decay : 4.877369984246433e-05
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 38
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 38 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:05:58,889][0m Trial 38 finished with values: [18050.889038372017, 12104.251370768174, 162.65418869783036] and parameters: {'learning_rate': 0.0005665905047332262, 'norm': 'None', 'weight_decay': 4.877369984246433e-05, 'train_batch_size': 78, 'training_loss': 'smooth', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.1731818124007618e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 31
INFO:echo.src.base_objective:	trainer:weight_decay : 5.702072442476775e-10
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 39
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 37 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:14:06,370][0m Trial 37 finished with values: [1.1362828512012937, 4.249823835711366, 2.312549865556797] and parameters: {'learning_rate': 2.408213133181997e-06, 'norm': 'zscore', 'weight_decay': 2.788724141409319e-10, 'train_batch_size': 5, 'training_loss': 'smooth', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.7343344382636848e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 116
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0007200673643747292
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 40
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 40 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:18:36,856][0m Trial 40 finished with values: [2.409571898758573, 7.655745030474821, 3.399959706814905] and parameters: {'learning_rate': 1.7343344382636848e-06, 'norm': 'minmax', 'weight_decay': 0.0007200673643747292, 'train_batch_size': 116, 'training_loss': 'huber', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0006372821117275482
INFO:echo.src.base_objective:	trainer:train_batch_size : 53
INFO:echo.src.base_objective:	trainer:weight_decay : 2.2147949347932095e-06
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 41
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 39 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:18:54,459][0m Trial 39 finished with values: [1.1105387378833038, 3.4091678133595154, 2.078839565947849] and parameters: {'learning_rate': 1.1731818124007618e-05, 'norm': 'minmax', 'weight_decay': 5.702072442476775e-10, 'train_batch_size': 31, 'training_loss': 'logcosh', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.006797499063019266
INFO:echo.src.base_objective:	trainer:train_batch_size : 10
INFO:echo.src.base_objective:	trainer:weight_decay : 1.204106282390783e-07
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 42
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 41 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:25:32,698][0m Trial 41 finished with values: [1.045171891883634, 1.8484210096671412, 1.4906826168236962] and parameters: {'learning_rate': 0.0006372821117275482, 'norm': 'minmax', 'weight_decay': 2.2147949347932095e-06, 'train_batch_size': 53, 'training_loss': 'smooth', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0029056254675701733
INFO:echo.src.base_objective:	trainer:train_batch_size : 10
INFO:echo.src.base_objective:	trainer:weight_decay : 0.00033643869608264687
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 43
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 42 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:29:20,025][0m Trial 42 finished with values: [0.9590280200026785, 0.3704726159894607, 0.6598440966476293] and parameters: {'learning_rate': 0.006797499063019266, 'norm': 'minmax', 'weight_decay': 1.204106282390783e-07, 'train_batch_size': 10, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0009757379726010104
INFO:echo.src.base_objective:	trainer:train_batch_size : 121
INFO:echo.src.base_objective:	trainer:weight_decay : 1.1099984714746179e-12
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 44
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 43 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:30:05,244][0m Trial 43 finished with values: [1.094857255722744, 3.5994022757021917, 2.053852159086515] and parameters: {'learning_rate': 0.0029056254675701733, 'norm': 'zscore', 'weight_decay': 0.00033643869608264687, 'train_batch_size': 10, 'training_loss': 'huber', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0036893204518289105
INFO:echo.src.base_objective:	trainer:train_batch_size : 28
INFO:echo.src.base_objective:	trainer:weight_decay : 5.958163674363907e-12
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 45
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 44 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:32:10,267][0m Trial 44 finished with values: [13.16503851893701, 12137.365944200452, 162.87918321189815] and parameters: {'learning_rate': 0.0009757379726010104, 'norm': 'None', 'weight_decay': 1.1099984714746179e-12, 'train_batch_size': 121, 'training_loss': 'xtanh', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00029748501296783525
INFO:echo.src.base_objective:	trainer:train_batch_size : 118
INFO:echo.src.base_objective:	trainer:weight_decay : 8.803754277025888e-11
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 46
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 45 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:33:02,248][0m Trial 45 finished with values: [26.20750486136065, 84.24837430962802, 13.046016287314787] and parameters: {'learning_rate': 0.0036893204518289105, 'norm': 'minmax', 'weight_decay': 5.958163674363907e-12, 'train_batch_size': 28, 'training_loss': 'huber', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 6.6862248281764474e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 111
INFO:echo.src.base_objective:	trainer:weight_decay : 4.6560294443688446e-10
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 47
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 46 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:40:31,288][0m Trial 46 finished with values: [1.084250167892818, 4.037665008056669, 2.2554802517785797] and parameters: {'learning_rate': 0.00029748501296783525, 'norm': 'zscore', 'weight_decay': 8.803754277025888e-11, 'train_batch_size': 118, 'training_loss': 'logcosh', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.000326494975457569
INFO:echo.src.base_objective:	trainer:train_batch_size : 36
INFO:echo.src.base_objective:	trainer:weight_decay : 7.2441380178985605e-06
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 48
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 48 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 19:43:45,413][0m Trial 48 finished with values: [21.84833527470463, 12066.747001627287, 162.40430423886872] and parameters: {'learning_rate': 0.000326494975457569, 'norm': 'None', 'weight_decay': 7.2441380178985605e-06, 'train_batch_size': 36, 'training_loss': 'xsigmoid', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.009203576048928748
INFO:echo.src.base_objective:	trainer:train_batch_size : 128
INFO:echo.src.base_objective:	trainer:weight_decay : 2.1258186307930386e-05
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 49
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 47 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29811.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:07:36,308][0m Trial 47 finished with values: [1.0973052775930974, 5.275174324051251, 2.873962814187109] and parameters: {'learning_rate': 6.6862248281764474e-06, 'norm': 'negone', 'weight_decay': 4.6560294443688446e-10, 'train_batch_size': 111, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29813.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 20:08:32,509][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29813.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 7.541371480536176e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 42
INFO:echo.src.base_objective:	trainer:weight_decay : 9.52120071407864e-08
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 50
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 49 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29812.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:14:32,147][0m Trial 49 finished with values: [0.9634325526488088, 0.4165428600514837, 0.7005477145020049] and parameters: {'learning_rate': 0.009203576048928748, 'norm': 'minmax', 'weight_decay': 2.1258186307930386e-05, 'train_batch_size': 128, 'training_loss': 'mse', 'model_name': 'linknet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:echo.src.base_objective:Saving trial 50 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:14:37,606][0m Trial 50 finished with values: [0.9982265818717877, 0.8244318542044766, 1.0109084225913685] and parameters: {'learning_rate': 7.541371480536176e-05, 'norm': 'minmax', 'weight_decay': 9.52120071407864e-08, 'train_batch_size': 42, 'training_loss': 'mse', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00014363624958655213
INFO:echo.src.base_objective:	trainer:train_batch_size : 27
INFO:echo.src.base_objective:	trainer:weight_decay : 7.945693383151309e-10
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 51
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29814.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 20:14:58,511][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29814.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29814.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.8094704719381707e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 38
INFO:echo.src.base_objective:	trainer:weight_decay : 7.173997046798131e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 52
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 51 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:23:24,316][0m Trial 51 finished with values: [1.0824125995210478, 1.7161436822315546, 1.3273882687550003] and parameters: {'learning_rate': 0.00014363624958655213, 'norm': 'negone', 'weight_decay': 7.945693383151309e-10, 'train_batch_size': 27, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 6.836487571764075e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 94
INFO:echo.src.base_objective:	trainer:weight_decay : 6.191710698097796e-05
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 53
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 53 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:31:17,739][0m Trial 53 finished with values: [1.1727616791656996, 4.128925798351751, 2.27442205443955] and parameters: {'learning_rate': 6.836487571764075e-05, 'norm': 'zscore', 'weight_decay': 6.191710698097796e-05, 'train_batch_size': 94, 'training_loss': 'smooth', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.129444767791241e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 74
INFO:echo.src.base_objective:	trainer:weight_decay : 7.089118767899794e-05
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 54
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 54 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:35:29,098][0m Trial 54 finished with values: [1.1563280997737841, 5.5351208365990665, 2.7653113804234466] and parameters: {'learning_rate': 4.129444767791241e-05, 'norm': 'zscore', 'weight_decay': 7.089118767899794e-05, 'train_batch_size': 74, 'training_loss': 'smooth', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.735029692918727e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 100
INFO:echo.src.base_objective:	trainer:weight_decay : 7.61959816710682e-06
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 55
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 52 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29814.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:36:20,713][0m Trial 52 finished with values: [1.0776803346595227, 1.5085231150526177, 1.2837859430742165] and parameters: {'learning_rate': 1.8094704719381707e-05, 'norm': 'negone', 'weight_decay': 7.173997046798131e-08, 'train_batch_size': 38, 'training_loss': 'xsigmoid', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0001844841742509137
INFO:echo.src.base_objective:	trainer:train_batch_size : 60
INFO:echo.src.base_objective:	trainer:weight_decay : 4.549818706312426e-07
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 56
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 55 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:38:16,785][0m Trial 55 finished with values: [14.237814947043931, 18.110673113439198, 5.291405474507604] and parameters: {'learning_rate': 4.735029692918727e-06, 'norm': 'minmax', 'weight_decay': 7.61959816710682e-06, 'train_batch_size': 100, 'training_loss': 'xtanh', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 3.341895100364569e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 57
INFO:echo.src.base_objective:	trainer:weight_decay : 1.4249034335311785e-11
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 57
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 56 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29814.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:45:07,752][0m Trial 56 finished with values: [1.0620855065882069, 1.4216948546289343, 1.2338801324019182] and parameters: {'learning_rate': 0.0001844841742509137, 'norm': 'minmax', 'weight_decay': 4.549818706312426e-07, 'train_batch_size': 60, 'training_loss': 'smooth', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.004650173103552172
INFO:echo.src.base_objective:	trainer:train_batch_size : 85
INFO:echo.src.base_objective:	trainer:weight_decay : 1.3736603528052226e-07
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 58
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 57 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 20:53:02,619][0m Trial 57 finished with values: [0.971446613017617, 0.5066323684130042, 0.7854787589251356] and parameters: {'learning_rate': 3.341895100364569e-05, 'norm': 'minmax', 'weight_decay': 1.4249034335311785e-11, 'train_batch_size': 57, 'training_loss': 'logcosh', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 7.509659978052965e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 120
INFO:echo.src.base_objective:	trainer:weight_decay : 9.338368093497487e-11
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 59
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 58 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29814.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:00:46,158][0m Trial 58 finished with values: [0.9992654357272517, 0.9333332168358807, 0.9321860129657432] and parameters: {'learning_rate': 0.004650173103552172, 'norm': 'negone', 'weight_decay': 1.3736603528052226e-07, 'train_batch_size': 85, 'training_loss': 'mse', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0021872276593804503
INFO:echo.src.base_objective:	trainer:train_batch_size : 40
INFO:echo.src.base_objective:	trainer:weight_decay : 0.00019632547770132675
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 60
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 59 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:09:03,921][0m Trial 59 finished with values: [0.9995704148461297, 2.586160751073394, 1.922922966005491] and parameters: {'learning_rate': 7.509659978052965e-05, 'norm': 'negone', 'weight_decay': 9.338368093497487e-11, 'train_batch_size': 120, 'training_loss': 'mse', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.961938364893448e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 30
INFO:echo.src.base_objective:	trainer:weight_decay : 2.451316329097341e-05
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 61
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 60 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29814.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:10:13,562][0m Trial 60 finished with values: [0.9934460669953492, 0.8849830965705073, 0.8963906658093451] and parameters: {'learning_rate': 0.0021872276593804503, 'norm': 'negone', 'weight_decay': 0.00019632547770132675, 'train_batch_size': 40, 'training_loss': 'logcosh', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.499727708676736e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 65
INFO:echo.src.base_objective:	trainer:weight_decay : 1.084592485543726e-06
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 62
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 61 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:12:07,046][0m Trial 61 finished with values: [18.35194571507617, 12100.127938445108, 162.62888218482112] and parameters: {'learning_rate': 2.961938364893448e-06, 'norm': 'None', 'weight_decay': 2.451316329097341e-05, 'train_batch_size': 30, 'training_loss': 'huber', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.1289987851043295e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 15
INFO:echo.src.base_objective:	trainer:weight_decay : 2.9923409986845876e-05
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 63
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 63 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:15:57,400][0m Trial 63 finished with values: [61.27643371451215, 12085.128675306234, 162.52786875609297] and parameters: {'learning_rate': 2.1289987851043295e-05, 'norm': 'None', 'weight_decay': 2.9923409986845876e-05, 'train_batch_size': 15, 'training_loss': 'xsigmoid', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 8.531765456229314e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 53
INFO:echo.src.base_objective:	trainer:weight_decay : 0.00038124278555552276
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 64
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 64 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:18:24,142][0m Trial 64 finished with values: [3.898538629251683, 12094.352013101101, 162.59026284912454] and parameters: {'learning_rate': 8.531765456229314e-06, 'norm': 'None', 'weight_decay': 0.00038124278555552276, 'train_batch_size': 53, 'training_loss': 'xsigmoid', 'model_name': 'pspnet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0014390542200185777
INFO:echo.src.base_objective:	trainer:train_batch_size : 115
INFO:echo.src.base_objective:	trainer:weight_decay : 5.079650090380997e-07
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 65
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 65 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29813.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:34:15,729][0m Trial 65 finished with values: [1.0805271287527263, 1.6230496133316203, 1.271136931710552] and parameters: {'learning_rate': 0.0014390542200185777, 'norm': 'negone', 'weight_decay': 5.079650090380997e-07, 'train_batch_size': 115, 'training_loss': 'mae', 'model_name': 'deeplabv3'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29815.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 21:34:39,139][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29815.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.004872609263480489
INFO:echo.src.base_objective:	trainer:train_batch_size : 52
INFO:echo.src.base_objective:	trainer:weight_decay : 2.904342019695146e-10
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 66
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 66 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:38:40,927][0m Trial 66 finished with values: [226.95965384573736, 12061.516225641763, 162.36866596874782] and parameters: {'learning_rate': 0.004872609263480489, 'norm': 'None', 'weight_decay': 2.904342019695146e-10, 'train_batch_size': 52, 'training_loss': 'huber', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0001325571211848526
INFO:echo.src.base_objective:	trainer:train_batch_size : 13
INFO:echo.src.base_objective:	trainer:weight_decay : 9.06479978525904e-10
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 67
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 62 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29814.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:41:37,947][0m Trial 62 finished with values: [1.1707834599858302, 2.695742718491639, 1.7083741863140305] and parameters: {'learning_rate': 2.499727708676736e-06, 'norm': 'minmax', 'weight_decay': 1.084592485543726e-06, 'train_batch_size': 65, 'training_loss': 'xtanh', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29816.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 21:42:02,070][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29816.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29816.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.0234651855809308e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 10
INFO:echo.src.base_objective:	trainer:weight_decay : 4.3321024794264956e-05
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 68
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 67 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:49:36,379][0m Trial 67 finished with values: [1.026951111568164, 1.262493899147706, 1.179970288539674] and parameters: {'learning_rate': 0.0001325571211848526, 'norm': 'minmax', 'weight_decay': 9.06479978525904e-10, 'train_batch_size': 13, 'training_loss': 'mae', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0017728644242675962
INFO:echo.src.base_objective:	trainer:train_batch_size : 15
INFO:echo.src.base_objective:	trainer:weight_decay : 1.954842764313202e-12
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 69
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 68 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29816.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:52:23,416][0m Trial 68 finished with values: [1.0866644277555018, 1.902237330772186, 1.4628371283946486] and parameters: {'learning_rate': 1.0234651855809308e-05, 'norm': 'minmax', 'weight_decay': 4.3321024794264956e-05, 'train_batch_size': 10, 'training_loss': 'logcosh', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.4737855820929227e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 98
INFO:echo.src.base_objective:	trainer:weight_decay : 1.418174317161037e-08
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 70
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 69 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 21:59:30,383][0m Trial 69 finished with values: [1.0421229387927633, 1.272362903657182, 1.1045847698353881] and parameters: {'learning_rate': 0.0017728644242675962, 'norm': 'negone', 'weight_decay': 1.954842764313202e-12, 'train_batch_size': 15, 'training_loss': 'smooth', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0005243032610041411
INFO:echo.src.base_objective:	trainer:train_batch_size : 36
INFO:echo.src.base_objective:	trainer:weight_decay : 1.3569791254567176e-09
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 71
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 70 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29816.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:08:42,723][0m Trial 70 finished with values: [1.127817645207545, 4.371476690691389, 2.416927698776109] and parameters: {'learning_rate': 1.4737855820929227e-05, 'norm': 'minmax', 'weight_decay': 1.418174317161037e-08, 'train_batch_size': 98, 'training_loss': 'mse', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 5.5512193621753565e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 45
INFO:echo.src.base_objective:	trainer:weight_decay : 5.790376962241808e-09
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 72
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 71 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:11:57,995][0m Trial 71 finished with values: [0.9623702935971195, 0.4028605921442006, 0.6932825707354546] and parameters: {'learning_rate': 0.0005243032610041411, 'norm': 'minmax', 'weight_decay': 1.3569791254567176e-09, 'train_batch_size': 36, 'training_loss': 'smooth', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.1691567973779505e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 100
INFO:echo.src.base_objective:	trainer:weight_decay : 6.895677297444062e-05
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 73
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 73 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:15:01,861][0m Trial 73 finished with values: [4.71167324727965, 12070.941791603529, 162.43276538750175] and parameters: {'learning_rate': 1.1691567973779505e-05, 'norm': 'None', 'weight_decay': 6.895677297444062e-05, 'train_batch_size': 100, 'training_loss': 'mse', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.260857603935773e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 58
INFO:echo.src.base_objective:	trainer:weight_decay : 4.506159670631628e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 74
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 72 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29816.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:16:03,643][0m Trial 72 finished with values: [1.0714470181714142, 1.5329553117315335, 1.2479300895998606] and parameters: {'learning_rate': 5.5512193621753565e-05, 'norm': 'minmax', 'weight_decay': 5.790376962241808e-09, 'train_batch_size': 45, 'training_loss': 'smooth', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0009782784324788385
INFO:echo.src.base_objective:	trainer:train_batch_size : 53
INFO:echo.src.base_objective:	trainer:weight_decay : 4.821275764196279e-12
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 75
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 74 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:18:13,248][0m Trial 74 finished with values: [9.139885572113887, 13.14415146364382, 4.488502816606152] and parameters: {'learning_rate': 1.260857603935773e-06, 'norm': 'negone', 'weight_decay': 4.506159670631628e-08, 'train_batch_size': 58, 'training_loss': 'xsigmoid', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00019383811480329274
INFO:echo.src.base_objective:	trainer:train_batch_size : 72
INFO:echo.src.base_objective:	trainer:weight_decay : 2.7741099632828576e-10
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 76
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 75 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29816.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:18:54,906][0m Trial 75 finished with values: [26.896062931867547, 12056.507611742445, 162.33530580550791] and parameters: {'learning_rate': 0.0009782784324788385, 'norm': 'None', 'weight_decay': 4.821275764196279e-12, 'train_batch_size': 53, 'training_loss': 'xtanh', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.001543829646653862
INFO:echo.src.base_objective:	trainer:train_batch_size : 113
INFO:echo.src.base_objective:	trainer:weight_decay : 3.225840810069256e-06
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 77
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 76 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:26:50,772][0m Trial 76 finished with values: [1.0852163207730339, 1.8288438232762836, 1.392896936341758] and parameters: {'learning_rate': 0.00019383811480329274, 'norm': 'negone', 'weight_decay': 2.7741099632828576e-10, 'train_batch_size': 72, 'training_loss': 'logcosh', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : deeplabv3+
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0002117026263908324
INFO:echo.src.base_objective:	trainer:train_batch_size : 90
INFO:echo.src.base_objective:	trainer:weight_decay : 6.752415201465598e-10
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 78
INFO:root:Loading model deeplabv3+ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 78 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:29:16,209][0m Trial 78 finished with values: [2.4036497535323638, 12101.238459978764, 162.63636305389312] and parameters: {'learning_rate': 0.0002117026263908324, 'norm': 'None', 'weight_decay': 6.752415201465598e-10, 'train_batch_size': 90, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3+'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.009370265556753596
INFO:echo.src.base_objective:	trainer:train_batch_size : 115
INFO:echo.src.base_objective:	trainer:weight_decay : 6.130607547006741e-06
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 79
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 79 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:37:56,334][0m Trial 79 finished with values: [1.2011408570689115, 3.834856891839889, 2.191821163739874] and parameters: {'learning_rate': 0.009370265556753596, 'norm': 'zscore', 'weight_decay': 6.130607547006741e-06, 'train_batch_size': 115, 'training_loss': 'huber', 'model_name': 'pspnet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.003715363789441839
INFO:echo.src.base_objective:	trainer:train_batch_size : 48
INFO:echo.src.base_objective:	trainer:weight_decay : 5.025754217386805e-09
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 80
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 80 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:44:06,249][0m Trial 80 finished with values: [1.1954199271243358, 3.8093753299369464, 2.1816529309993924] and parameters: {'learning_rate': 0.003715363789441839, 'norm': 'zscore', 'weight_decay': 5.025754217386805e-09, 'train_batch_size': 48, 'training_loss': 'xtanh', 'model_name': 'pspnet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 6.671854689730093e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 82
INFO:echo.src.base_objective:	trainer:weight_decay : 1.2819747667737204e-11
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 81
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 77 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29816.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:50:55,691][0m Trial 77 finished with values: [0.9629209390642203, 0.4103080146331468, 0.6905006562840991] and parameters: {'learning_rate': 0.001543829646653862, 'norm': 'minmax', 'weight_decay': 3.225840810069256e-06, 'train_batch_size': 113, 'training_loss': 'logcosh', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 3.278099906653877e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 62
INFO:echo.src.base_objective:	trainer:weight_decay : 1.0760786862749657e-06
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 82
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 81 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 22:53:03,180][0m Trial 81 finished with values: [1.1898569264361054, 4.243614869358704, 2.097893475791711] and parameters: {'learning_rate': 6.671854689730093e-06, 'norm': 'minmax', 'weight_decay': 1.2819747667737204e-11, 'train_batch_size': 82, 'training_loss': 'logcosh', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0010208522623232218
INFO:echo.src.base_objective:	trainer:train_batch_size : 13
INFO:echo.src.base_objective:	trainer:weight_decay : 0.000279636987561752
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 83
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 83 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29815.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:01:54,550][0m Trial 83 finished with values: [1.0798266168067743, 1.6036690690266076, 1.2716455114338492] and parameters: {'learning_rate': 0.0010208522623232218, 'norm': 'negone', 'weight_decay': 0.000279636987561752, 'train_batch_size': 13, 'training_loss': 'mae', 'model_name': 'deeplabv3'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29817.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 23:02:53,348][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29817.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002448449289114721
INFO:echo.src.base_objective:	trainer:train_batch_size : 49
INFO:echo.src.base_objective:	trainer:weight_decay : 9.944007125656899e-05
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 84
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 82 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29816.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:06:50,749][0m Trial 82 finished with values: [1.2950798694431258, 3.226795907537123, 2.1009752904658647] and parameters: {'learning_rate': 3.278099906653877e-06, 'norm': 'negone', 'weight_decay': 1.0760786862749657e-06, 'train_batch_size': 62, 'training_loss': 'xtanh', 'model_name': 'fpn'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29818.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-15 23:07:45,093][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29818.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29818.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 7.976449068198952e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 28
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0009090012253586355
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 85
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 84 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:10:47,565][0m Trial 84 finished with values: [1.2004482575417585, 3.805324193029856, 2.1856205621838853] and parameters: {'learning_rate': 0.002448449289114721, 'norm': 'zscore', 'weight_decay': 9.944007125656899e-05, 'train_batch_size': 49, 'training_loss': 'logcosh', 'model_name': 'pspnet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.4133958269760825e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 86
INFO:echo.src.base_objective:	trainer:weight_decay : 1.2487097863069158e-07
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 86
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 85 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29818.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:10:48,712][0m Trial 85 finished with values: [3.363698754270117, 12082.510398339658, 162.51099774742013] and parameters: {'learning_rate': 7.976449068198952e-05, 'norm': 'None', 'weight_decay': 0.0009090012253586355, 'train_batch_size': 28, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.905720662390903e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 18
INFO:echo.src.base_objective:	trainer:weight_decay : 1.3106341895431222e-08
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 87
INFO:root:Loading model linknet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 86 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:20:35,523][0m Trial 86 finished with values: [3.3699036459929377, 12080.91972935831, 162.50048374175802] and parameters: {'learning_rate': 4.4133958269760825e-06, 'norm': 'None', 'weight_decay': 1.2487097863069158e-07, 'train_batch_size': 86, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : pspnet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00929281161418972
INFO:echo.src.base_objective:	trainer:train_batch_size : 13
INFO:echo.src.base_objective:	trainer:weight_decay : 6.582839754379622e-10
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 88
INFO:root:Loading model pspnet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 88 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:24:01,523][0m Trial 88 finished with values: [32.72115702676542, 6.431494444368609, 3.0281208257801913] and parameters: {'learning_rate': 0.00929281161418972, 'norm': 'zscore', 'weight_decay': 6.582839754379622e-10, 'train_batch_size': 13, 'training_loss': 'huber', 'model_name': 'pspnet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0001580488864531804
INFO:echo.src.base_objective:	trainer:train_batch_size : 46
INFO:echo.src.base_objective:	trainer:weight_decay : 1.900307759627449e-05
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 89
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 89 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:26:57,073][0m Trial 89 finished with values: [147.57001188748575, 12056.507611742445, 162.33530580550791] and parameters: {'learning_rate': 0.0001580488864531804, 'norm': 'None', 'weight_decay': 1.900307759627449e-05, 'train_batch_size': 46, 'training_loss': 'smooth', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0001751592278721706
INFO:echo.src.base_objective:	trainer:train_batch_size : 70
INFO:echo.src.base_objective:	trainer:weight_decay : 2.834644543541862e-12
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 90
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 90 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:29:46,527][0m Trial 90 finished with values: [35.613485373891315, 12079.573756458907, 162.49058590976657] and parameters: {'learning_rate': 0.0001751592278721706, 'norm': 'None', 'weight_decay': 2.834644543541862e-12, 'train_batch_size': 70, 'training_loss': 'mse', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.004962861488763251
INFO:echo.src.base_objective:	trainer:train_batch_size : 52
INFO:echo.src.base_objective:	trainer:weight_decay : 2.691359874908621e-08
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 91
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 91 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:32:21,124][0m Trial 91 finished with values: [9297.411825686968, 12056.507611742445, 162.33530580550791] and parameters: {'learning_rate': 0.004962861488763251, 'norm': 'None', 'weight_decay': 2.691359874908621e-08, 'train_batch_size': 52, 'training_loss': 'mse', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.977693129474864e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 97
INFO:echo.src.base_objective:	trainer:weight_decay : 8.450621633455464e-06
INFO:echo.src.base_objective:	trainer:training_loss : xtanh
INFO:echo.src.base_objective:Beginning trial 92
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 87 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29818.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:42:48,882][0m Trial 87 finished with values: [1.1198504501011581, 4.6517686636252975, 2.5951392965533358] and parameters: {'learning_rate': 4.905720662390903e-06, 'norm': 'negone', 'weight_decay': 1.3106341895431222e-08, 'train_batch_size': 18, 'training_loss': 'logcosh', 'model_name': 'linknet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 5.147498376145928e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 104
INFO:echo.src.base_objective:	trainer:weight_decay : 3.597325254016482e-06
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 93
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 92 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:45:42,900][0m Trial 92 finished with values: [1.2294641488708884, 5.02242656018898, 2.5955528989484304] and parameters: {'learning_rate': 2.977693129474864e-06, 'norm': 'zscore', 'weight_decay': 8.450621633455464e-06, 'train_batch_size': 97, 'training_loss': 'xtanh', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0002060117729654799
INFO:echo.src.base_objective:	trainer:train_batch_size : 90
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0007136982976987652
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 94
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 94 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:48:04,645][0m Trial 94 finished with values: [25.019574540824557, 12121.434409212174, 162.77196465395133] and parameters: {'learning_rate': 0.0002060117729654799, 'norm': 'None', 'weight_decay': 0.0007136982976987652, 'train_batch_size': 90, 'training_loss': 'mae', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0054514443743185394
INFO:echo.src.base_objective:	trainer:train_batch_size : 99
INFO:echo.src.base_objective:	trainer:weight_decay : 2.33779976958586e-11
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 95
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 95 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:52:17,644][0m Trial 95 finished with values: [14.520674544761993, 12056.642526819503, 162.3362127090091] and parameters: {'learning_rate': 0.0054514443743185394, 'norm': 'None', 'weight_decay': 2.33779976958586e-11, 'train_batch_size': 99, 'training_loss': 'smooth', 'model_name': 'unet++'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.6422996865997474e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 46
INFO:echo.src.base_objective:	trainer:weight_decay : 4.547659598285072e-09
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 96
INFO:root:Loading model fpn with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 93 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29818.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-15 23:58:04,096][0m Trial 93 finished with values: [1.0863801832868576, 1.610728225155834, 1.3585409922969605] and parameters: {'learning_rate': 5.147498376145928e-05, 'norm': 'negone', 'weight_decay': 3.597325254016482e-06, 'train_batch_size': 104, 'training_loss': 'smooth', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	optimizer:learning_rate : 3.1805174141372966e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 43
INFO:echo.src.base_objective:	trainer:weight_decay : 3.6903146541493926e-10
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 97
INFO:root:Loading model unet++ with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 96 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:12:29,506][0m Trial 96 finished with values: [1.1932690567337354, 3.7687278898014376, 2.1498153623563563] and parameters: {'learning_rate': 1.6422996865997474e-05, 'norm': 'zscore', 'weight_decay': 4.547659598285072e-09, 'train_batch_size': 46, 'training_loss': 'smooth', 'model_name': 'fpn'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.000390877528064621
INFO:echo.src.base_objective:	trainer:train_batch_size : 34
INFO:echo.src.base_objective:	trainer:weight_decay : 0.00028132642574449736
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 98
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 98 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:15:22,851][0m Trial 98 finished with values: [26747.16715303372, 12073.98243654154, 162.45275631778873] and parameters: {'learning_rate': 0.000390877528064621, 'norm': 'None', 'weight_decay': 0.00028132642574449736, 'train_batch_size': 34, 'training_loss': 'huber', 'model_name': 'unet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0005024417053441236
INFO:echo.src.base_objective:	trainer:train_batch_size : 35
INFO:echo.src.base_objective:	trainer:weight_decay : 6.418056749538174e-10
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 99
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 99 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:19:07,690][0m Trial 99 finished with values: [14.77941067265319, 12060.845983717183, 162.36473460715894] and parameters: {'learning_rate': 0.0005024417053441236, 'norm': 'None', 'weight_decay': 6.418056749538174e-10, 'train_batch_size': 35, 'training_loss': 'smooth', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.3860744890608772e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 14
INFO:echo.src.base_objective:	trainer:weight_decay : 2.6458786925298e-07
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 100
INFO:root:Loading model deeplabv3 with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 100 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:23:38,650][0m Trial 100 finished with values: [3.5650165313879536, 12069.879804829929, 162.42603086963646] and parameters: {'learning_rate': 1.3860744890608772e-05, 'norm': 'None', 'weight_decay': 2.6458786925298e-07, 'train_batch_size': 14, 'training_loss': 'xsigmoid', 'model_name': 'deeplabv3'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0066337302026373965
INFO:echo.src.base_objective:	trainer:train_batch_size : 22
INFO:echo.src.base_objective:	trainer:weight_decay : 2.189854340132391e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 101
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 97 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29818.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:32:17,496][0m Trial 97 finished with values: [0.992608650415982, 0.7484277230083016, 0.9878152736819777] and parameters: {'learning_rate': 3.1805174141372966e-06, 'norm': 'minmax', 'weight_decay': 3.6903146541493926e-10, 'train_batch_size': 43, 'training_loss': 'xsigmoid', 'model_name': 'unet++'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:echo.src.base_objective:Saving trial 101 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29817.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:32:23,396][0m Trial 101 finished with values: [0.9617364840593089, 0.4054740510836839, 0.6999211013341545] and parameters: {'learning_rate': 0.0066337302026373965, 'norm': 'minmax', 'weight_decay': 2.189854340132391e-09, 'train_batch_size': 22, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29820.gusched01
INFO:root:Running on PBS/SLURM batch id: 29819.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-16 00:33:59,180][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
[32m[I 2023-05-16 00:33:59,182][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29819.gusched01 is summoned.
INFO:echo.src.base_objective:Worker 29820.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.006987433076427495
INFO:echo.src.base_objective:	trainer:train_batch_size : 20
INFO:echo.src.base_objective:	trainer:weight_decay : 1.3825333541607815e-05
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 103
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0061605800062870236
INFO:echo.src.base_objective:	trainer:train_batch_size : 19
INFO:echo.src.base_objective:	trainer:weight_decay : 1.6763224335293494e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 102
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 102 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:41:40,070][0m Trial 102 finished with values: [0.9631238303900141, 0.4147483852224918, 0.69435506450282] and parameters: {'learning_rate': 0.0061605800062870236, 'norm': 'minmax', 'weight_decay': 1.6763224335293494e-09, 'train_batch_size': 19, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.007143110758623483
INFO:echo.src.base_objective:	trainer:train_batch_size : 20
INFO:echo.src.base_objective:	trainer:weight_decay : 1.5267934812316881e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 104
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 103 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:48:44,413][0m Trial 103 finished with values: [0.9584802411318466, 0.37446581180835864, 0.6691472795158696] and parameters: {'learning_rate': 0.006987433076427495, 'norm': 'minmax', 'weight_decay': 1.3825333541607815e-05, 'train_batch_size': 20, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.006464953044895833
INFO:echo.src.base_objective:	trainer:train_batch_size : 21
INFO:echo.src.base_objective:	trainer:weight_decay : 1.5278143870317222e-05
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 105
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 104 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:56:00,772][0m Trial 104 finished with values: [0.9585543966918144, 0.375421975178379, 0.6686828583650385] and parameters: {'learning_rate': 0.007143110758623483, 'norm': 'minmax', 'weight_decay': 1.5267934812316881e-09, 'train_batch_size': 20, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00666079234865356
INFO:echo.src.base_objective:	trainer:train_batch_size : 23
INFO:echo.src.base_objective:	trainer:weight_decay : 1.5082271504025292e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 106
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 105 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 00:58:52,417][0m Trial 105 finished with values: [0.9606517350504904, 0.38396160339402274, 0.6607556535902749] and parameters: {'learning_rate': 0.006464953044895833, 'norm': 'minmax', 'weight_decay': 1.5278143870317222e-05, 'train_batch_size': 21, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.006970152273409945
INFO:echo.src.base_objective:	trainer:train_batch_size : 22
INFO:echo.src.base_objective:	trainer:weight_decay : 2.2366685872092216e-06
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 107
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 107 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:03:16,901][0m Trial 107 finished with values: [0.9734686419162291, 0.562910891252814, 0.8110455440325541] and parameters: {'learning_rate': 0.006970152273409945, 'norm': 'minmax', 'weight_decay': 2.2366685872092216e-06, 'train_batch_size': 22, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.006918637534999957
INFO:echo.src.base_objective:	trainer:train_batch_size : 20
INFO:echo.src.base_objective:	trainer:weight_decay : 2.1093826302306626e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 108
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 106 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:06:31,110][0m Trial 106 finished with values: [0.9611842157863488, 0.3896322081377738, 0.6732584274896429] and parameters: {'learning_rate': 0.00666079234865356, 'norm': 'minmax', 'weight_decay': 1.5082271504025292e-09, 'train_batch_size': 23, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.006970218723257492
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 8.968170688640422e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 109
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 108 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:13:27,789][0m Trial 108 finished with values: [0.9596820722407965, 0.3772541081598563, 0.6612718249585643] and parameters: {'learning_rate': 0.006918637534999957, 'norm': 'minmax', 'weight_decay': 2.1093826302306626e-09, 'train_batch_size': 20, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.007516710136709087
INFO:echo.src.base_objective:	trainer:train_batch_size : 7
INFO:echo.src.base_objective:	trainer:weight_decay : 1.6191966112055169e-07
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 110
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 109 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:18:09,507][0m Trial 109 finished with values: [0.9581521565785472, 0.3783238004029212, 0.6747714786313492] and parameters: {'learning_rate': 0.006970218723257492, 'norm': 'minmax', 'weight_decay': 8.968170688640422e-08, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.007183826771872206
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 1.557866396348042e-07
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 111
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 110 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:19:15,522][0m Trial 110 finished with values: [0.9633032337375508, 0.42142632800043084, 0.7093965933718043] and parameters: {'learning_rate': 0.007516710136709087, 'norm': 'minmax', 'weight_decay': 1.6191966112055169e-07, 'train_batch_size': 7, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0068011899032491725
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 9.429049666706594e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 112
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 111 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:37:02,286][0m Trial 111 finished with values: [0.9571805997988251, 0.3497550669128384, 0.6402654559313629] and parameters: {'learning_rate': 0.007183826771872206, 'norm': 'minmax', 'weight_decay': 1.557866396348042e-07, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.007708951416112255
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 7.086516151466903e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 113
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 112 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:37:55,645][0m Trial 112 finished with values: [0.9574608681908005, 0.35469109907388313, 0.64492258230984] and parameters: {'learning_rate': 0.0068011899032491725, 'norm': 'minmax', 'weight_decay': 9.429049666706594e-08, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.007689060386907665
INFO:echo.src.base_objective:	trainer:train_batch_size : 5
INFO:echo.src.base_objective:	trainer:weight_decay : 8.733898290404609e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 114
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 113 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:48:53,123][0m Trial 113 finished with values: [0.9576935387540132, 0.3728667368935769, 0.6634941202407078] and parameters: {'learning_rate': 0.007708951416112255, 'norm': 'minmax', 'weight_decay': 7.086516151466903e-08, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.007714388428795761
INFO:echo.src.base_objective:	trainer:train_batch_size : 5
INFO:echo.src.base_objective:	trainer:weight_decay : 8.309781218589751e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 115
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 114 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:51:19,581][0m Trial 114 finished with values: [0.9609949733177563, 0.39989837071013745, 0.696097936817733] and parameters: {'learning_rate': 0.007689060386907665, 'norm': 'minmax', 'weight_decay': 8.733898290404609e-08, 'train_batch_size': 5, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0059761486910645326
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 8.29843938633423e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 116
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 115 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29819.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 01:54:57,759][0m Trial 115 finished with values: [0.9622662207522916, 0.40920970331706, 0.6960784132844956] and parameters: {'learning_rate': 0.007714388428795761, 'norm': 'minmax', 'weight_decay': 8.309781218589751e-08, 'train_batch_size': 5, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29821.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-16 01:55:54,768][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29821.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29821.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.004622594813901e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 0.00014734121539521436
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 117
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 116 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29820.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:04:08,084][0m Trial 116 finished with values: [0.9572566251618847, 0.3482835567087774, 0.6377213777365726] and parameters: {'learning_rate': 0.0059761486910645326, 'norm': 'minmax', 'weight_decay': 8.29843938633423e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29822.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-16 02:04:32,517][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29822.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0030952029738569716
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 3.0300392552357234e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 118
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 118 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:16:17,438][0m Trial 118 finished with values: [0.9571954015497779, 0.3592289766275652, 0.6500625040396776] and parameters: {'learning_rate': 0.0030952029738569716, 'norm': 'minmax', 'weight_decay': 3.0300392552357234e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.003252110630524239
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 7.082885365079917e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 119
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 117 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29821.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:24:41,211][0m Trial 117 finished with values: [1.1259271269526334, 2.0569969542091884, 1.5560435649118767] and parameters: {'learning_rate': 1.004622594813901e-06, 'norm': 'minmax', 'weight_decay': 0.00014734121539521436, 'train_batch_size': 8, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.003326944613154625
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 2.8058646210907534e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 120
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 119 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:26:20,235][0m Trial 119 finished with values: [0.9578785125547069, 0.3492195997054888, 0.6348245905056105] and parameters: {'learning_rate': 0.003252110630524239, 'norm': 'minmax', 'weight_decay': 7.082885365079917e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0020500898219383014
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 8.301860498309179e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 121
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 120 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29821.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:34:12,724][0m Trial 120 finished with values: [0.9581160500924635, 0.3593386175735734, 0.6523015402600812] and parameters: {'learning_rate': 0.003326944613154625, 'norm': 'minmax', 'weight_decay': 2.8058646210907534e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002199872368053337
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 7.01868804228043e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 122
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 121 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:36:23,091][0m Trial 121 finished with values: [0.957619119491388, 0.34527920670792894, 0.6320243169765243] and parameters: {'learning_rate': 0.0020500898219383014, 'norm': 'minmax', 'weight_decay': 8.301860498309179e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00039688883763237776
INFO:echo.src.base_objective:	trainer:train_batch_size : 10
INFO:echo.src.base_objective:	trainer:weight_decay : 8.083966889046723e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 123
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 123 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:47:22,351][0m Trial 123 finished with values: [0.9582329719902644, 0.3537936265591061, 0.6440951686196602] and parameters: {'learning_rate': 0.00039688883763237776, 'norm': 'minmax', 'weight_decay': 8.083966889046723e-09, 'train_batch_size': 10, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0004262011329611891
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 8.189345983116899e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 124
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 122 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29821.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:47:40,354][0m Trial 122 finished with values: [0.9582499255325202, 0.3601659530074821, 0.6484948595943406] and parameters: {'learning_rate': 0.002199872368053337, 'norm': 'minmax', 'weight_decay': 7.01868804228043e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002087196450299102
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 7.877689294016792e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 125
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 124 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:59:08,010][0m Trial 124 finished with values: [0.9570476395168938, 0.34835011465103827, 0.6401328441087761] and parameters: {'learning_rate': 0.0004262011329611891, 'norm': 'minmax', 'weight_decay': 8.189345983116899e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0024188948073013616
INFO:echo.src.base_objective:	trainer:train_batch_size : 10
INFO:echo.src.base_objective:	trainer:weight_decay : 6.96110043356576e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 126
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 125 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29821.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 02:59:31,201][0m Trial 125 finished with values: [0.9574148970960227, 0.35748681336559274, 0.648315503200695] and parameters: {'learning_rate': 0.002087196450299102, 'norm': 'minmax', 'weight_decay': 7.877689294016792e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0019236781206441779
INFO:echo.src.base_objective:	trainer:train_batch_size : 4
INFO:echo.src.base_objective:	trainer:weight_decay : 3.306564298138828e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 127
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 126 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:13:17,077][0m Trial 126 finished with values: [0.9577712040520158, 0.359868533607122, 0.652550491773757] and parameters: {'learning_rate': 0.0024188948073013616, 'norm': 'minmax', 'weight_decay': 6.96110043356576e-09, 'train_batch_size': 10, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002131220783610123
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 8.439359075195617e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 128
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 127 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29821.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:16:26,522][0m Trial 127 finished with values: [0.9583604914678876, 0.36665281189129645, 0.6586052823391751] and parameters: {'learning_rate': 0.0019236781206441779, 'norm': 'minmax', 'weight_decay': 3.306564298138828e-09, 'train_batch_size': 4, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002839421812561315
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 2.140641012986328e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 129
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 128 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:23:59,679][0m Trial 128 finished with values: [0.9573758787548472, 0.3491209698741377, 0.631246551434771] and parameters: {'learning_rate': 0.002131220783610123, 'norm': 'minmax', 'weight_decay': 8.439359075195617e-09, 'train_batch_size': 8, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0033238229919427846
INFO:echo.src.base_objective:	trainer:train_batch_size : 7
INFO:echo.src.base_objective:	trainer:weight_decay : 8.331702825756097e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 130
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 129 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29821.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:27:19,032][0m Trial 129 finished with values: [0.9573573990389704, 0.3451582353319566, 0.6278836190539159] and parameters: {'learning_rate': 0.002839421812561315, 'norm': 'minmax', 'weight_decay': 2.140641012986328e-08, 'train_batch_size': 8, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29823.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-16 03:28:16,356][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29823.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0026906304175544297
INFO:echo.src.base_objective:	trainer:train_batch_size : 9
INFO:echo.src.base_objective:	trainer:weight_decay : 7.790699642014143e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 131
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 130 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29822.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:32:17,381][0m Trial 130 finished with values: [0.9606743062557311, 0.3849185808426283, 0.675182062618489] and parameters: {'learning_rate': 0.0033238229919427846, 'norm': 'minmax', 'weight_decay': 8.331702825756097e-09, 'train_batch_size': 7, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29824.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-16 03:32:43,131][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29824.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002555168020625143
INFO:echo.src.base_objective:	trainer:train_batch_size : 11
INFO:echo.src.base_objective:	trainer:weight_decay : 2.2777448357051833e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 132
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 131 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:39:41,830][0m Trial 131 finished with values: [0.9589616763116334, 0.3630631814951853, 0.6519887705355131] and parameters: {'learning_rate': 0.0026906304175544297, 'norm': 'minmax', 'weight_decay': 7.790699642014143e-09, 'train_batch_size': 9, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0026273633025043516
INFO:echo.src.base_objective:	trainer:train_batch_size : 12
INFO:echo.src.base_objective:	trainer:weight_decay : 2.0301148939111995e-08
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 133
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 132 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:45:44,946][0m Trial 132 finished with values: [0.9585296719884218, 0.3582921406060251, 0.6457681887269637] and parameters: {'learning_rate': 0.002555168020625143, 'norm': 'minmax', 'weight_decay': 2.2777448357051833e-08, 'train_batch_size': 11, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0021806351141397404
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 2.2650720963994147e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 134
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 133 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 03:49:59,935][0m Trial 133 finished with values: [0.95856635454022, 0.36258668585983256, 0.6473510013394868] and parameters: {'learning_rate': 0.0026273633025043516, 'norm': 'minmax', 'weight_decay': 2.0301148939111995e-08, 'train_batch_size': 12, 'training_loss': 'xsigmoid', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0012528680321792732
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 3.441710455083105e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 135
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 134 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:02:23,064][0m Trial 134 finished with values: [0.9570116602619068, 0.3426654038904226, 0.629134667706591] and parameters: {'learning_rate': 0.0021806351141397404, 'norm': 'minmax', 'weight_decay': 2.2650720963994147e-08, 'train_batch_size': 8, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0020149894262478157
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 2.0804652353320486e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 136
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 135 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:03:11,184][0m Trial 135 finished with values: [0.9585422477055636, 0.3580265404496771, 0.6455566358946949] and parameters: {'learning_rate': 0.0012528680321792732, 'norm': 'minmax', 'weight_decay': 3.441710455083105e-08, 'train_batch_size': 8, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0012306525736858526
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 4.066210629280856e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 137
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 137 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:12:23,858][0m Trial 137 finished with values: [0.9584666069460784, 0.362745003090902, 0.6509937508663474] and parameters: {'learning_rate': 0.0012306525736858526, 'norm': 'minmax', 'weight_decay': 4.066210629280856e-08, 'train_batch_size': 8, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0017227377110986116
INFO:echo.src.base_objective:	trainer:train_batch_size : 7
INFO:echo.src.base_objective:	trainer:weight_decay : 3.594678434745422e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 138
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 136 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:13:06,843][0m Trial 136 finished with values: [0.9585716266913019, 0.36126634513650435, 0.6393277214240123] and parameters: {'learning_rate': 0.0020149894262478157, 'norm': 'minmax', 'weight_decay': 2.0804652353320486e-08, 'train_batch_size': 8, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.003316152958648756
INFO:echo.src.base_objective:	trainer:train_batch_size : 17
INFO:echo.src.base_objective:	trainer:weight_decay : 9.092052658414385e-09
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 139
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 139 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:26:01,109][0m Trial 139 finished with values: [0.9584623076936429, 0.3780102046996392, 0.6759498168674435] and parameters: {'learning_rate': 0.003316152958648756, 'norm': 'minmax', 'weight_decay': 9.092052658414385e-09, 'train_batch_size': 17, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.001955738067903846
INFO:echo.src.base_objective:	trainer:train_batch_size : 7
INFO:echo.src.base_objective:	trainer:weight_decay : 2.6621092306914587e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 140
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 138 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:28:19,693][0m Trial 138 finished with values: [0.9581945196946745, 0.3565674098544465, 0.6440579967802351] and parameters: {'learning_rate': 0.0017227377110986116, 'norm': 'minmax', 'weight_decay': 3.594678434745422e-08, 'train_batch_size': 7, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002027470889342172
INFO:echo.src.base_objective:	trainer:train_batch_size : 12
INFO:echo.src.base_objective:	trainer:weight_decay : 2.077194681395676e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 141
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 140 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:32:16,715][0m Trial 140 finished with values: [0.9597862069265745, 0.3866116818340034, 0.6770970172608298] and parameters: {'learning_rate': 0.001955738067903846, 'norm': 'minmax', 'weight_decay': 2.6621092306914587e-08, 'train_batch_size': 7, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.001945980056064881
INFO:echo.src.base_objective:	trainer:train_batch_size : 11
INFO:echo.src.base_objective:	trainer:weight_decay : 1.0797515467496028e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 142
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 142 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:39:45,352][0m Trial 142 finished with values: [0.9614066261352877, 0.4176278724113722, 0.7112508148542058] and parameters: {'learning_rate': 0.001945980056064881, 'norm': 'minmax', 'weight_decay': 1.0797515467496028e-08, 'train_batch_size': 11, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00011407062119264296
INFO:echo.src.base_objective:	trainer:train_batch_size : 7
INFO:echo.src.base_objective:	trainer:weight_decay : 4.165887647275096e-09
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 143
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 141 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:40:36,073][0m Trial 141 finished with values: [0.9583710754612568, 0.3636860709175015, 0.6539682239146919] and parameters: {'learning_rate': 0.002027470889342172, 'norm': 'minmax', 'weight_decay': 2.077194681395676e-08, 'train_batch_size': 12, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002926329587295407
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 1.695602697772072e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 144
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 144 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:48:49,475][0m Trial 144 finished with values: [0.9606042443202505, 0.383854025716153, 0.6668561150080379] and parameters: {'learning_rate': 0.002926329587295407, 'norm': 'minmax', 'weight_decay': 1.695602697772072e-08, 'train_batch_size': 8, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 9.92649743211356e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 16
INFO:echo.src.base_objective:	trainer:weight_decay : 5.672029179300221e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 145
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 143 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:51:06,451][0m Trial 143 finished with values: [0.9606213558236062, 0.38058194912954857, 0.6704686189373191] and parameters: {'learning_rate': 0.00011407062119264296, 'norm': 'minmax', 'weight_decay': 4.165887647275096e-09, 'train_batch_size': 7, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 9.735142865712099e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 127
INFO:echo.src.base_objective:	trainer:weight_decay : 5.1607721147067394e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 146
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 146 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29824.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 04:57:24,758][0m Trial 146 finished with values: [1.0188393241636189, 1.0066045634185674, 1.1299770075991762] and parameters: {'learning_rate': 9.735142865712099e-05, 'norm': 'minmax', 'weight_decay': 5.1607721147067394e-08, 'train_batch_size': 127, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29825.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-16 04:57:47,729][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29825.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29825.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.001698010502187842
INFO:echo.src.base_objective:	trainer:train_batch_size : 17
INFO:echo.src.base_objective:	trainer:weight_decay : 9.528884004336546e-09
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 147
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 145 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29823.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:06:37,942][0m Trial 145 finished with values: [0.9768086755142706, 0.5619329582985578, 0.833523830188754] and parameters: {'learning_rate': 9.92649743211356e-06, 'norm': 'minmax', 'weight_decay': 5.672029179300221e-08, 'train_batch_size': 16, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:root:Saving trial details to /glade/work/kdagon/s2sml/results_week3_SH_515/
INFO:root:Running on PBS/SLURM batch id: 29826.gusched01
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: ['minimize', 'minimize', 'minimize']
INFO:root:Using metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
[32m[I 2023-05-16 05:07:01,429][0m Using an existing study with name 'vanilla' instead of creating a new one.[0m
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results_week3_SH_515/s2s.db
INFO:echo.src.base_objective:Worker 29826.gusched01 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric ['valid_custom', 'valid_custom_second', 'valid_custom_third']
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 2:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.001757425977594258
INFO:echo.src.base_objective:	trainer:train_batch_size : 12
INFO:echo.src.base_objective:	trainer:weight_decay : 1.0841047893905396e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 148
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 148 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:14:31,092][0m Trial 148 finished with values: [0.9593676500356608, 0.37011479336166075, 0.6529449397345882] and parameters: {'learning_rate': 0.001757425977594258, 'norm': 'minmax', 'weight_decay': 1.0841047893905396e-08, 'train_batch_size': 12, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.002296409686523208
INFO:echo.src.base_objective:	trainer:train_batch_size : 10
INFO:echo.src.base_objective:	trainer:weight_decay : 3.166892272897318e-09
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 149
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 147 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29825.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:19:34,416][0m Trial 147 finished with values: [0.9582339874199163, 0.36052083512728883, 0.6494793840411464] and parameters: {'learning_rate': 0.001698010502187842, 'norm': 'minmax', 'weight_decay': 9.528884004336546e-09, 'train_batch_size': 17, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.003833916796662326
INFO:echo.src.base_objective:	trainer:train_batch_size : 79
INFO:echo.src.base_objective:	trainer:weight_decay : 3.230593535535558e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 150
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 149 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:20:06,711][0m Trial 149 finished with values: [0.9616113102763347, 0.41044951693068005, 0.7021875854343614] and parameters: {'learning_rate': 0.002296409686523208, 'norm': 'minmax', 'weight_decay': 3.166892272897318e-09, 'train_batch_size': 10, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.001249203846311307
INFO:echo.src.base_objective:	trainer:train_batch_size : 80
INFO:echo.src.base_objective:	trainer:weight_decay : 3.042238519970303e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 151
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 151 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:38:37,258][0m Trial 151 finished with values: [0.9638125291933354, 0.42082497657102885, 0.7039562874896073] and parameters: {'learning_rate': 0.001249203846311307, 'norm': 'minmax', 'weight_decay': 3.042238519970303e-08, 'train_batch_size': 80, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.2867702498875098e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 8
INFO:echo.src.base_objective:	trainer:weight_decay : 3.373983832822305e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 152
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 150 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29825.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:40:33,475][0m Trial 150 finished with values: [0.9639382767388563, 0.42128405373182537, 0.6974680018968828] and parameters: {'learning_rate': 0.003833916796662326, 'norm': 'minmax', 'weight_decay': 3.230593535535558e-08, 'train_batch_size': 79, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00037048560119463443
INFO:echo.src.base_objective:	trainer:train_batch_size : 9
INFO:echo.src.base_objective:	trainer:weight_decay : 4.647471298350953e-09
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 153
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 153 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29825.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:48:07,472][0m Trial 153 finished with values: [0.9621574818531456, 0.40490585230287324, 0.6917241511973794] and parameters: {'learning_rate': 0.00037048560119463443, 'norm': 'minmax', 'weight_decay': 4.647471298350953e-09, 'train_batch_size': 9, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00011999781943133503
INFO:echo.src.base_objective:	trainer:train_batch_size : 6
INFO:echo.src.base_objective:	trainer:weight_decay : 3.6481066231893165e-11
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 154
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 152 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:55:19,113][0m Trial 152 finished with values: [0.9630877942145986, 0.4103836748161407, 0.7028167997236037] and parameters: {'learning_rate': 2.2867702498875098e-05, 'norm': 'minmax', 'weight_decay': 3.373983832822305e-08, 'train_batch_size': 8, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0004635169609527252
INFO:echo.src.base_objective:	trainer:train_batch_size : 6
INFO:echo.src.base_objective:	trainer:weight_decay : 0.00016210784998736867
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 155
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 154 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29825.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 05:57:34,371][0m Trial 154 finished with values: [0.9612300164682271, 0.39249286625041147, 0.6803339767277669] and parameters: {'learning_rate': 0.00011999781943133503, 'norm': 'minmax', 'weight_decay': 3.6481066231893165e-11, 'train_batch_size': 6, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 5.437761841137449e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 12
INFO:echo.src.base_objective:	trainer:weight_decay : 5.347170157830856e-11
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 156
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 156 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29825.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 06:10:17,518][0m Trial 156 finished with values: [1.0534671032546112, 1.4149997881290304, 1.2536072487567018] and parameters: {'learning_rate': 5.437761841137449e-06, 'norm': 'minmax', 'weight_decay': 5.347170157830856e-11, 'train_batch_size': 12, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0013774286042435471
INFO:echo.src.base_objective:	trainer:train_batch_size : 7
INFO:echo.src.base_objective:	trainer:weight_decay : 0.0009566905794611744
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 157
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 155 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 06:10:58,847][0m Trial 155 finished with values: [0.9580513477214126, 0.3704309576232375, 0.6657515155388422] and parameters: {'learning_rate': 0.0004635169609527252, 'norm': 'minmax', 'weight_decay': 0.00016210784998736867, 'train_batch_size': 6, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0013470924890094987
INFO:echo.src.base_objective:	trainer:train_batch_size : 14
INFO:echo.src.base_objective:	trainer:weight_decay : 2.0453404748990053e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 158
INFO:root:Loading model manet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 157 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29825.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 06:21:05,682][0m Trial 157 finished with values: [0.9573435617538048, 0.3471301968373243, 0.6348320611682127] and parameters: {'learning_rate': 0.0013774286042435471, 'norm': 'minmax', 'weight_decay': 0.0009566905794611744, 'train_batch_size': 7, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
INFO:echo.src.base_objective:Saving trial 158 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 06:25:10,123][0m Trial 158 finished with values: [0.9583569733354906, 0.3554077619277145, 0.6401375472991997] and parameters: {'learning_rate': 0.0013470924890094987, 'norm': 'minmax', 'weight_decay': 2.0453404748990053e-08, 'train_batch_size': 14, 'training_loss': 'mae', 'model_name': 'manet'}. [0m
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.0007278481004589142
INFO:echo.src.base_objective:	trainer:train_batch_size : 14
INFO:echo.src.base_objective:	trainer:weight_decay : 4.441927037131999e-11
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 159
INFO:root:Loading model unet with settings {'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 159 results to local file /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results/trial_results_29826.gusched01.csv
INFO:echo.src.base_objective:Merging trial results and saving to /glade/work/kdagon/s2sml/results_week3_SH_515/trial_results.csv
[32m[I 2023-05-16 06:35:48,047][0m Trial 159 finished with values: [0.9581698724103741, 0.35943972473027436, 0.6499746708243072] and parameters: {'learning_rate': 0.0007278481004589142, 'norm': 'minmax', 'weight_decay': 4.441927037131999e-11, 'train_batch_size': 14, 'training_loss': 'mae', 'model_name': 'unet'}. [0m
WARNING:root:Stopping early since the longest observed run-time in the study exceeds the time remaining on this node.
