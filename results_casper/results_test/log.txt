INFO:root:Running as __main__
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
WARNING:echo.src.reporting:The gpu is not responding to a call from nvidia-smi.                Setting device = cpu, but this may fail. Command '['nvidia-smi', '--query-gpu=memory.free', '--format=csv,nounits,noheader']' returned non-zero exit status 9.
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: minimize
INFO:root:Using metric valid_mae
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results/s2s.db
INFO:echo.src.base_objective:Worker 0 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric valid_mae
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results/trial_results.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 1:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : None
INFO:echo.src.base_objective:	model:name : linknet
INFO:echo.src.base_objective:	model:encoder_name : efficientnet-b0
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.6444928912866254e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 157
INFO:echo.src.base_objective:	trainer:weight_decay : 2.8641987005085253e-05
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 0
INFO:root:Loading model linknet with settings {'encoder_name': 'efficientnet-b0', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 0 results to local file /glade/work/kdagon/s2sml/results/trial_results.csv
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	model:encoder_name : densenet121
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.005074573692024809
INFO:echo.src.base_objective:	trainer:train_batch_size : 35
INFO:echo.src.base_objective:	trainer:weight_decay : 7.835627206177697e-07
INFO:echo.src.base_objective:	trainer:training_loss : mse
INFO:echo.src.base_objective:Beginning trial 1
INFO:root:Loading model unet with settings {'encoder_name': 'densenet121', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
WARNING:root:Trial 1 failed due to error: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)>.
WARNING:root:Died due to due to error <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)>
INFO:root:Running as __main__
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
WARNING:echo.src.reporting:The gpu is not responding to a call from nvidia-smi.                Setting device = cpu, but this may fail. Command '['nvidia-smi', '--query-gpu=memory.free', '--format=csv,nounits,noheader']' returned non-zero exit status 9.
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: minimize
INFO:root:Using metric valid_mae
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results/s2s.db
INFO:echo.src.base_objective:Worker 0 is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric valid_mae
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results/trial_results.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 1:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	model:encoder_name : resnet18
INFO:echo.src.base_objective:	optimizer:learning_rate : 2.41889865083268e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 92
INFO:echo.src.base_objective:	trainer:weight_decay : 8.566425273347554e-05
INFO:echo.src.base_objective:	trainer:training_loss : logcosh
INFO:echo.src.base_objective:Beginning trial 2
INFO:root:Loading model fpn with settings {'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 2 results to local file /glade/work/kdagon/s2sml/results/trial_results.csv
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : minmax
INFO:echo.src.base_objective:	model:name : deeplabv3
INFO:echo.src.base_objective:	model:encoder_name : resnet18
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.004111729531616641
INFO:echo.src.base_objective:	trainer:train_batch_size : 110
INFO:echo.src.base_objective:	trainer:weight_decay : 1.1705532437037115e-08
INFO:echo.src.base_objective:	trainer:training_loss : mae
INFO:echo.src.base_objective:Beginning trial 3
INFO:root:Loading model deeplabv3 with settings {'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 3 results to local file /glade/work/kdagon/s2sml/results/trial_results.csv
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : fpn
INFO:echo.src.base_objective:	model:encoder_name : resnet152
INFO:echo.src.base_objective:	optimizer:learning_rate : 4.477084618212312e-06
INFO:echo.src.base_objective:	trainer:train_batch_size : 131
INFO:echo.src.base_objective:	trainer:weight_decay : 2.781170839050081e-09
INFO:echo.src.base_objective:	trainer:training_loss : xsigmoid
INFO:echo.src.base_objective:Beginning trial 4
INFO:root:Loading model fpn with settings {'encoder_name': 'resnet152', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 4 results to local file /glade/work/kdagon/s2sml/results/trial_results.csv
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : unet
INFO:echo.src.base_objective:	model:encoder_name : efficientnet-b0
INFO:echo.src.base_objective:	optimizer:learning_rate : 1.577868091261638e-05
INFO:echo.src.base_objective:	trainer:train_batch_size : 127
INFO:echo.src.base_objective:	trainer:weight_decay : 1.8689094245115438e-11
INFO:echo.src.base_objective:	trainer:training_loss : smooth
INFO:echo.src.base_objective:Beginning trial 5
INFO:root:Loading model unet with settings {'encoder_name': 'efficientnet-b0', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
INFO:root:Loading loss smooth
INFO:echo.src.base_objective:Saving trial 5 results to local file /glade/work/kdagon/s2sml/results/trial_results.csv
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : negone
INFO:echo.src.base_objective:	model:name : unet++
INFO:echo.src.base_objective:	model:encoder_name : xception
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.00010968736388592485
INFO:echo.src.base_objective:	trainer:train_batch_size : 148
INFO:echo.src.base_objective:	trainer:weight_decay : 3.109308931292932e-05
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 6
INFO:root:Loading model unet++ with settings {'encoder_name': 'xception', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
WARNING:root:Trial 6 failed due to error: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)>.
WARNING:root:Died due to due to error <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)>
INFO:root:Current hyperparameter configuration settings:
INFO:root:	log: True
INFO:root:	save_path: /glade/work/kdagon/s2sml/results/
INFO:root:	pbs.jobs: 1
INFO:root:	pbs.bash: ['source ~/.bashrc; conda load s2sml-env']
INFO:root:	pbs.batch.N: s2sml-kdagon
INFO:root:	pbs.batch.l: ['select=1:ncpus=1:ngpus=1:mem=32GB', 'walltime=1:00:00', 'gpu_type=v100']
INFO:root:	pbs.batch.A: acgd0007
INFO:root:	pbs.batch.q: casper
INFO:root:	pbs.batch.o: /glade/work/kdagon/s2sml/results/out
INFO:root:	pbs.batch.e: /glade/work/kdagon/s2sml/results/err
INFO:root:	optuna.storage: s2s.db
INFO:root:	optuna.study_name: vanilla
INFO:root:	optuna.storage_type: sqlite
INFO:root:	optuna.objective: /glade/work/kdagon/s2sml/applications/train.py
INFO:root:	optuna.direction: minimize
INFO:root:	optuna.metric: valid_mae
INFO:root:	optuna.n_trials: 1000
INFO:root:	optuna.gpu: True
INFO:root:	optuna.sampler.type: TPESampler
INFO:root:	optuna.sampler.n_startup_trials: 100
INFO:root:	optuna.pruner.type: MedianPruner
INFO:root:	optuna.pruner.n_startup_trials: 50
INFO:root:	optuna.parameters.optimizer:learning_rate.type: loguniform
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.name: learning_rate
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.low: 1e-06
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.high: 0.01
INFO:root:	optuna.parameters.data:norm.type: categorical
INFO:root:	optuna.parameters.data:norm.settings.name: norm
INFO:root:	optuna.parameters.data:norm.settings.choices: ['None', 'minmax', 'negone', 'zscore']
INFO:root:	optuna.parameters.trainer:weight_decay.type: loguniform
INFO:root:	optuna.parameters.trainer:weight_decay.settings.name: weight_decay
INFO:root:	optuna.parameters.trainer:weight_decay.settings.low: 1e-12
INFO:root:	optuna.parameters.trainer:weight_decay.settings.high: 0.001
INFO:root:	optuna.parameters.trainer:train_batch_size.type: int
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.name: train_batch_size
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.low: 4
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.high: 256
INFO:root:	optuna.parameters.trainer:training_loss.type: categorical
INFO:root:	optuna.parameters.trainer:training_loss.settings.name: training_loss
INFO:root:	optuna.parameters.trainer:training_loss.settings.choices: ['mae', 'mse', 'smooth', 'logcosh', 'xtanh', 'xsigmoid', 'huber']
INFO:root:	optuna.parameters.model:name.type: categorical
INFO:root:	optuna.parameters.model:name.settings.name: model_name
INFO:root:	optuna.parameters.model:name.settings.choices: ['unet', 'unet++', 'manet', 'linknet', 'fpn', 'pspnet', 'pan', 'deeplabv3', 'deeplabv3+']
INFO:root:	optuna.parameters.model:encoder_name.type: categorical
INFO:root:	optuna.parameters.model:encoder_name.settings.name: encoder_name
INFO:root:	optuna.parameters.model:encoder_name.settings.choices: ['resnet18', 'resnet152', 'densenet121', 'xception', 'efficientnet-b0', 'mobilenet_v2', 'dpn68', 'vgg11']
INFO:root:Current model configuration settings:
INFO:root:	seed: 1000
INFO:root:	save_loc: /glade/work/kdagon/s2sml/results/echo-opt
INFO:root:	data.homedir: /glade/scratch/molina/
INFO:root:	data.var: prsfc
INFO:root:	data.wks: 2
INFO:root:	data.dxdy: 31
INFO:root:	data.lon0: 250.0
INFO:root:	data.lat0: 30
INFO:root:	data.norm: minmax
INFO:root:	model.name: unet
INFO:root:	model.encoder_name: resnet18
INFO:root:	model.encoder_weights: imagenet
INFO:root:	model.in_channels: 4
INFO:root:	model.classes: 1
INFO:root:	model.activation: sigmoid
INFO:root:	optimizer.learning_rate: 0.001
INFO:root:	optimizer.weight_decay: 0.0
INFO:root:	trainer.epochs: 1
INFO:root:	trainer.train_batch_size: 32
INFO:root:	trainer.valid_batch_size: 32
INFO:root:	trainer.batches_per_epoch: 100
INFO:root:	trainer.lr_patience: 2
INFO:root:	trainer.stopping_patience: 5
INFO:root:	trainer.loss: smooth
INFO:root:	trainer.metric: valid_mae
WARNING:root:The study 'vanilla' exists in sqlite:////glade/work/kdagon/s2sml/results/s2s.db.
INFO:root:	If you want to delete the study 'vanilla' first, pass '--delete_study 1'.
INFO:root:Checking the study for broken trials (those that did not complete 1 epoch before dying)
INFO:root:	All trials check out!
INFO:echo.src.reporting:Summary statistics for the current study:
INFO:echo.src.reporting:	Total number of trials in the study: 7
INFO:echo.src.reporting:	Trials with state COMPLETE: 5
INFO:echo.src.reporting:	Trials with state FAIL: 2
INFO:echo.src.reporting:	Requested number of trials: 1000
INFO:echo.src.reporting:	...
INFO:echo.src.reporting:	Total study simulation run time: 0.1610 hrs
INFO:echo.src.reporting:	Average trial simulation run time: 0.0230 hrs
INFO:echo.src.reporting:	The longest trial took 0.0365 hrs
INFO:echo.src.reporting:	Estimated remaining simulation time needed: 22.8909 hrs
INFO:echo.src.reporting:	With a given wall-time of 1:00:00, submit 23 PBS workers to complete the study
INFO:root:Submitted pbs batch job 1/1 with id 5842207.casper-pbs
INFO:root:Current hyperparameter configuration settings:
INFO:root:	log: True
INFO:root:	save_path: /glade/work/kdagon/s2sml/results/
INFO:root:	pbs.jobs: 1
INFO:root:	pbs.bash: ['source ~/.bashrc; conda activate s2sml-env']
INFO:root:	pbs.batch.N: s2sml-kdagon
INFO:root:	pbs.batch.l: ['select=1:ncpus=1:ngpus=1:mem=32GB', 'walltime=1:00:00', 'gpu_type=v100']
INFO:root:	pbs.batch.A: acgd0007
INFO:root:	pbs.batch.q: casper
INFO:root:	pbs.batch.o: /glade/work/kdagon/s2sml/results/out
INFO:root:	pbs.batch.e: /glade/work/kdagon/s2sml/results/err
INFO:root:	optuna.storage: s2s.db
INFO:root:	optuna.study_name: vanilla
INFO:root:	optuna.storage_type: sqlite
INFO:root:	optuna.objective: /glade/work/kdagon/s2sml/applications/train.py
INFO:root:	optuna.direction: minimize
INFO:root:	optuna.metric: valid_mae
INFO:root:	optuna.n_trials: 1000
INFO:root:	optuna.gpu: True
INFO:root:	optuna.sampler.type: TPESampler
INFO:root:	optuna.sampler.n_startup_trials: 100
INFO:root:	optuna.pruner.type: MedianPruner
INFO:root:	optuna.pruner.n_startup_trials: 50
INFO:root:	optuna.parameters.optimizer:learning_rate.type: loguniform
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.name: learning_rate
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.low: 1e-06
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.high: 0.01
INFO:root:	optuna.parameters.data:norm.type: categorical
INFO:root:	optuna.parameters.data:norm.settings.name: norm
INFO:root:	optuna.parameters.data:norm.settings.choices: ['None', 'minmax', 'negone', 'zscore']
INFO:root:	optuna.parameters.trainer:weight_decay.type: loguniform
INFO:root:	optuna.parameters.trainer:weight_decay.settings.name: weight_decay
INFO:root:	optuna.parameters.trainer:weight_decay.settings.low: 1e-12
INFO:root:	optuna.parameters.trainer:weight_decay.settings.high: 0.001
INFO:root:	optuna.parameters.trainer:train_batch_size.type: int
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.name: train_batch_size
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.low: 4
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.high: 256
INFO:root:	optuna.parameters.trainer:training_loss.type: categorical
INFO:root:	optuna.parameters.trainer:training_loss.settings.name: training_loss
INFO:root:	optuna.parameters.trainer:training_loss.settings.choices: ['mae', 'mse', 'smooth', 'logcosh', 'xtanh', 'xsigmoid', 'huber']
INFO:root:	optuna.parameters.model:name.type: categorical
INFO:root:	optuna.parameters.model:name.settings.name: model_name
INFO:root:	optuna.parameters.model:name.settings.choices: ['unet', 'unet++', 'manet', 'linknet', 'fpn', 'pspnet', 'pan', 'deeplabv3', 'deeplabv3+']
INFO:root:	optuna.parameters.model:encoder_name.type: categorical
INFO:root:	optuna.parameters.model:encoder_name.settings.name: encoder_name
INFO:root:	optuna.parameters.model:encoder_name.settings.choices: ['resnet18', 'resnet152', 'densenet121', 'xception', 'efficientnet-b0', 'mobilenet_v2', 'dpn68', 'vgg11']
INFO:root:Current model configuration settings:
INFO:root:	seed: 1000
INFO:root:	save_loc: /glade/work/kdagon/s2sml/results/echo-opt
INFO:root:	data.homedir: /glade/scratch/molina/
INFO:root:	data.var: prsfc
INFO:root:	data.wks: 2
INFO:root:	data.dxdy: 31
INFO:root:	data.lon0: 250.0
INFO:root:	data.lat0: 30
INFO:root:	data.norm: minmax
INFO:root:	model.name: unet
INFO:root:	model.encoder_name: resnet18
INFO:root:	model.encoder_weights: imagenet
INFO:root:	model.in_channels: 4
INFO:root:	model.classes: 1
INFO:root:	model.activation: sigmoid
INFO:root:	optimizer.learning_rate: 0.001
INFO:root:	optimizer.weight_decay: 0.0
INFO:root:	trainer.epochs: 1
INFO:root:	trainer.train_batch_size: 32
INFO:root:	trainer.valid_batch_size: 32
INFO:root:	trainer.batches_per_epoch: 100
INFO:root:	trainer.lr_patience: 2
INFO:root:	trainer.stopping_patience: 5
INFO:root:	trainer.loss: smooth
INFO:root:	trainer.metric: valid_mae
WARNING:root:The study 'vanilla' exists in sqlite:////glade/work/kdagon/s2sml/results/s2s.db.
INFO:root:	If you want to delete the study 'vanilla' first, pass '--delete_study 1'.
INFO:root:Checking the study for broken trials (those that did not complete 1 epoch before dying)
INFO:root:	All trials check out!
INFO:echo.src.reporting:Summary statistics for the current study:
INFO:echo.src.reporting:	Total number of trials in the study: 7
INFO:echo.src.reporting:	Trials with state COMPLETE: 5
INFO:echo.src.reporting:	Trials with state FAIL: 2
INFO:echo.src.reporting:	Requested number of trials: 1000
INFO:echo.src.reporting:	...
INFO:echo.src.reporting:	Total study simulation run time: 0.1610 hrs
INFO:echo.src.reporting:	Average trial simulation run time: 0.0230 hrs
INFO:echo.src.reporting:	The longest trial took 0.0365 hrs
INFO:echo.src.reporting:	Estimated remaining simulation time needed: 22.8909 hrs
INFO:echo.src.reporting:	With a given wall-time of 1:00:00, submit 23 PBS workers to complete the study
INFO:root:Submitted pbs batch job 1/1 with id 5842250.casper-pbs
INFO:root:Running on PBS/SLURM batch id: 5842250.casper-pbs
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:root:Current hyperparameter configuration settings:
INFO:root:	log: True
INFO:root:	save_path: /glade/work/kdagon/s2sml/results/
INFO:root:	pbs.jobs: 1
INFO:root:	pbs.bash: ['source ~/.bashrc; module unload cuda; conda activate s2sml-env']
INFO:root:	pbs.batch.N: s2sml-kdagon
INFO:root:	pbs.batch.l: ['select=1:ncpus=1:ngpus=1:mem=32GB', 'walltime=1:00:00', 'gpu_type=v100']
INFO:root:	pbs.batch.A: acgd0007
INFO:root:	pbs.batch.q: casper
INFO:root:	pbs.batch.o: /glade/work/kdagon/s2sml/results/out
INFO:root:	pbs.batch.e: /glade/work/kdagon/s2sml/results/err
INFO:root:	optuna.storage: s2s.db
INFO:root:	optuna.study_name: vanilla
INFO:root:	optuna.storage_type: sqlite
INFO:root:	optuna.objective: /glade/work/kdagon/s2sml/applications/train.py
INFO:root:	optuna.direction: minimize
INFO:root:	optuna.metric: valid_mae
INFO:root:	optuna.n_trials: 1000
INFO:root:	optuna.gpu: True
INFO:root:	optuna.sampler.type: TPESampler
INFO:root:	optuna.sampler.n_startup_trials: 100
INFO:root:	optuna.pruner.type: MedianPruner
INFO:root:	optuna.pruner.n_startup_trials: 50
INFO:root:	optuna.parameters.optimizer:learning_rate.type: loguniform
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.name: learning_rate
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.low: 1e-06
INFO:root:	optuna.parameters.optimizer:learning_rate.settings.high: 0.01
INFO:root:	optuna.parameters.data:norm.type: categorical
INFO:root:	optuna.parameters.data:norm.settings.name: norm
INFO:root:	optuna.parameters.data:norm.settings.choices: ['None', 'minmax', 'negone', 'zscore']
INFO:root:	optuna.parameters.trainer:weight_decay.type: loguniform
INFO:root:	optuna.parameters.trainer:weight_decay.settings.name: weight_decay
INFO:root:	optuna.parameters.trainer:weight_decay.settings.low: 1e-12
INFO:root:	optuna.parameters.trainer:weight_decay.settings.high: 0.001
INFO:root:	optuna.parameters.trainer:train_batch_size.type: int
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.name: train_batch_size
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.low: 4
INFO:root:	optuna.parameters.trainer:train_batch_size.settings.high: 256
INFO:root:	optuna.parameters.trainer:training_loss.type: categorical
INFO:root:	optuna.parameters.trainer:training_loss.settings.name: training_loss
INFO:root:	optuna.parameters.trainer:training_loss.settings.choices: ['mae', 'mse', 'smooth', 'logcosh', 'xtanh', 'xsigmoid', 'huber']
INFO:root:	optuna.parameters.model:name.type: categorical
INFO:root:	optuna.parameters.model:name.settings.name: model_name
INFO:root:	optuna.parameters.model:name.settings.choices: ['unet', 'unet++', 'manet', 'linknet', 'fpn', 'pspnet', 'pan', 'deeplabv3', 'deeplabv3+']
INFO:root:	optuna.parameters.model:encoder_name.type: categorical
INFO:root:	optuna.parameters.model:encoder_name.settings.name: encoder_name
INFO:root:	optuna.parameters.model:encoder_name.settings.choices: ['resnet18', 'resnet152', 'densenet121', 'xception', 'efficientnet-b0', 'mobilenet_v2', 'dpn68', 'vgg11']
INFO:root:Current model configuration settings:
INFO:root:	seed: 1000
INFO:root:	save_loc: /glade/work/kdagon/s2sml/results/echo-opt
INFO:root:	data.homedir: /glade/scratch/molina/
INFO:root:	data.var: prsfc
INFO:root:	data.wks: 2
INFO:root:	data.dxdy: 31
INFO:root:	data.lon0: 250.0
INFO:root:	data.lat0: 30
INFO:root:	data.norm: minmax
INFO:root:	model.name: unet
INFO:root:	model.encoder_name: resnet18
INFO:root:	model.encoder_weights: imagenet
INFO:root:	model.in_channels: 4
INFO:root:	model.classes: 1
INFO:root:	model.activation: sigmoid
INFO:root:	optimizer.learning_rate: 0.001
INFO:root:	optimizer.weight_decay: 0.0
INFO:root:	trainer.epochs: 1
INFO:root:	trainer.train_batch_size: 32
INFO:root:	trainer.valid_batch_size: 32
INFO:root:	trainer.batches_per_epoch: 100
INFO:root:	trainer.lr_patience: 2
INFO:root:	trainer.stopping_patience: 5
INFO:root:	trainer.loss: smooth
INFO:root:	trainer.metric: valid_mae
WARNING:root:The study 'vanilla' exists in sqlite:////glade/work/kdagon/s2sml/results/s2s.db.
INFO:root:	If you want to delete the study 'vanilla' first, pass '--delete_study 1'.
INFO:root:Checking the study for broken trials (those that did not complete 1 epoch before dying)
INFO:root:	All trials check out!
INFO:echo.src.reporting:Summary statistics for the current study:
INFO:echo.src.reporting:	Total number of trials in the study: 7
INFO:echo.src.reporting:	Trials with state COMPLETE: 5
INFO:echo.src.reporting:	Trials with state FAIL: 2
INFO:echo.src.reporting:	Requested number of trials: 1000
INFO:echo.src.reporting:	...
INFO:echo.src.reporting:	Total study simulation run time: 0.1610 hrs
INFO:echo.src.reporting:	Average trial simulation run time: 0.0230 hrs
INFO:echo.src.reporting:	The longest trial took 0.0365 hrs
INFO:echo.src.reporting:	Estimated remaining simulation time needed: 22.8909 hrs
INFO:echo.src.reporting:	With a given wall-time of 1:00:00, submit 23 PBS workers to complete the study
INFO:root:Submitted pbs batch job 1/1 with id 5842288.casper-pbs
INFO:root:Running on PBS/SLURM batch id: 5842288.casper-pbs
INFO:root:Importing custom objective from /glade/work/kdagon/s2sml/applications/train.py
INFO:echo.src.reporting:Using device 0
INFO:root:Direction of optimization: minimize
INFO:root:Using metric valid_mae
INFO:root:Loaded study vanilla located at sqlite:////glade/work/kdagon/s2sml/results/s2s.db
INFO:echo.src.base_objective:Worker 5842288.casper-pbs is summoned.
INFO:echo.src.base_objective:	initializing an objective to be optimized with metric valid_mae
INFO:echo.src.base_objective:	using device(s) cuda:0
INFO:echo.src.base_objective:	saving study/trial results to local file /glade/work/kdagon/s2sml/results/trial_results/trial_results_5842288.casper-pbs.csv
INFO:root:Running optimization for 1000 trials
INFO:root:Running trials for a maximum PBS wall-time 1:00:00
WARNING:root:Attempting to run trials and stop before hitting the wall-time
WARNING:root:Some trials may not complete if the wall-time is reached. Optuna will start over.
INFO:echo.src.base_objective:Attempting to automatically update the model configuration using optuna's suggested parameters
INFO:echo.src.base_objective:	data:norm : zscore
INFO:echo.src.base_objective:	model:name : manet
INFO:echo.src.base_objective:	model:encoder_name : dpn68
INFO:echo.src.base_objective:	optimizer:learning_rate : 0.009800119141318505
INFO:echo.src.base_objective:	trainer:train_batch_size : 77
INFO:echo.src.base_objective:	trainer:weight_decay : 6.179278672525946e-07
INFO:echo.src.base_objective:	trainer:training_loss : huber
INFO:echo.src.base_objective:Beginning trial 7
INFO:root:Loading model manet with settings {'encoder_name': 'dpn68', 'encoder_weights': 'imagenet', 'in_channels': 4, 'classes': 1, 'activation': 'sigmoid'}
WARNING:root:Trial 7 failed due to error: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)>.
WARNING:root:Died due to due to error <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:997)>
